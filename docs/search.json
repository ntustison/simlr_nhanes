[{"path":"https://github.com/stnava/simlr_nhanes/articles/simlr_nhanes.html","id":"nhanes-example","dir":"Articles","previous_headings":"","what":"NHANES example","title":"simlr: nhanes application explained","text":"five publicly available data categories : - Demographics (DEMO) - Dietary (DIET) - Examination (EXAM) - Laboratory (LAB) - Questionnaire (Q). abbreviated forms parentheses may substituted long form nhanesA commands. INDFMPIR: Poverty Income Ratio (0 = income, higher values = higher income relative poverty threshold). • INDHHIN2: Annual Household Income (categorized ranges). • DMDEDUC2: Education Level (adults 20+ years). • OCD390G: Employment Status (occupation questionnaire).","code":"# Demographic data (e.g., 2011-2012 cycle) demo_data <- nhanes('DEMO_G') cog_data <- nhanes('CFQ_G') depression_data <- nhanes('DPQ_G') sleep_data <- nhanes('SLQ_G') bp = nhanes( \"BPX_G\") bm = nhanes( \"BMX_G\") env_data <- nhanes('PBCD_G')  # Example for phthalates and blood metals  # Demographic data (e.g., 2013-2014 cycle) demo_data13 <- nhanes('DEMO_H') cog_data13<- nhanes('CFQ_H') depression_data13 <- nhanes('DPQ_H') sleep_data13 <- nhanes('SLQ_H') bp13 = nhanes( \"BPX_H\") bm13 = nhanes( \"BMX_H\") env_data13 <- nhanes('PBCD_H')  # Example for phthalates and blood metals   phdata <- nhanes('PHTHTE_G')  # Example for phthalates and blood metals phdata13 <- nhanes('PHTHTE_H')  # Example for phthalates and blood metals # pfasd <- nhanes('SSPFAS_G')  # Example for phthalates and blood metals # pfasd13 <- nhanes('SSPFAS_H')  # Example for phthalates and blood metals vocd <- nhanes('VOCWB_G')  # Example for phthalates and blood metals vocd13 <- nhanes('VOCWB_H')  # Example for phthalates and blood metals hvmt <- nhanes('UAS_G')  # Example for phthalates and blood metals hvmt13 <- nhanes('UAS_H')  # Example for phthalates and blood metals pst <- nhanes('PSTPOL_G')  # Example for phthalates and blood metals pst13 <- nhanes('PSTPOL_H')  # Example for phthalates and blood metals pfc <- nhanes('PFC_G')  # Example for phthalates and blood metals pfc13 <- nhanes('PFC_H')  # Example for phthalates and blood metals ## simpleWarning in download.file(url, tf, mode = \"wb\", quiet = TRUE): downloaded length 0 != reported length 1245 mm <- nhanes('UHM_G')  # Example for phthalates and blood metals mm13 <- nhanes('UHM_H')  # Example for phthalates and blood metals ## simpleWarning in download.file(url, tf, mode = \"wb\", quiet = TRUE): downloaded length 0 != reported length 1245 cu <- nhanes('CUSEZN_G')  # Example for phthalates and blood metals cu13 <- nhanes('CUSEZN_H')  # Example for phthalates and blood metals ig <- nhanes('IHgEM_G')  # Example for phthalates and blood metals ig13 <- nhanes('IHgEM_H')  # Example for phthalates and blood metals uh <- nhanes('UHG_G')  # Example for phthalates and blood metals uh13 <- nhanes('UHG_H')  # Example for phthalates and blood metals  di <- nhanes('DR1TOT_G')  # Example for phthalates and blood metals di13 <- nhanes('DR1TOT_H')  # Example for phthalates and blood metals   merge_nhanes_data <- function( joinid, nacol,  ...) {   datasets <- list(...)   dfout <- Reduce(function(x, y) {     left_join(x, y, by = joinid)  # Adjust \"ID\" to your common column name   }, datasets)   dfout = dfout[ !is.na( dfout[,nacol] ), ]   return( dfout ) }  merged_data <- merge_nhanes_data( 'SEQN', 'CFDDS',   merge_same_type_columns(cog_data, cog_data13),   merge_same_type_columns(demo_data,demo_data13),   merge_same_type_columns(di,di13),   merge_same_type_columns(depression_data,depression_data13),   merge_same_type_columns(sleep_data,sleep_data13),   merge_same_type_columns(bp,bp13),   merge_same_type_columns(bm,bm13),   merge_same_type_columns(env_data, env_data13),   merge_same_type_columns(phdata, phdata13),   merge_same_type_columns(vocd, vocd13),   merge_same_type_columns(cu, cu13),   merge_same_type_columns(ig, ig13),   merge_same_type_columns(uh, uh13),   mm, #  merge_same_type_columns(pst, pst13) ) #  merge_same_type_columns(pfc, pfc13) ,   merge_same_type_columns(hvmt, hvmt13))  table(merged_data$RIAGENDR) ##  ##   Male Female  ##   1469   1545 nhanescog$SEQN = nhanescog$seqn merged_data=merge(nhanescog, merged_data, by='SEQN')   depnames = c(    getNamesFromDataframe( \"SLQ\", merged_data ), #  getNamesFromDataframe( \"DPQ\", merged_data, exclusions='DPQ100' )   getNamesFromDataframe( \"DPQ\", merged_data ) ) for ( x in depnames ) merged_data[,x]=map_freq_to_numeric(merged_data,x)   # deek   idata = impute_data(merged_data) idata = idata[ idata$BPXDI1 > 20 & idata$BPXDI2 > 20 & idata$BPXDI3 > 20 & idata$BPXDI4 > 20,  ] fdata <- filter_na_columns(merged_data, max_na_percent = 0.5)  # Removes columns with >10% NAs fdata = fdata[ na2f(fdata$BPXDI1 > 20 & fdata$BPXDI2 > 20 & fdata$BPXDI3 > 20 ),  ] fdata$race = factor( fdata$race ) fdata$riagendr = factor( fdata$riagendr )  myformR =  create_formula( fdata, 'z_digit_re', c('SEQN', 'RIDAGEMN','RIDRETH3', 'CFASTAT', 'CFDCRNC', 'CFDCIT', 'CFDCST', 'CFDAPP', 'CFDAST', 'CFALANG', 'BPAARM', 'CFDCCS', 'CFDCST', 'CFDCIT', 'CFDCSR', 'CFDCIR', 'CFDCST', 'CFDCIT', 'CFDARNC', 'CFDDS', 'INDHHIN2','DMDHRBR4','INDFMIN2','PEASCST1','PEASCCT1','PEASCTM1','BPACSZ','BPXML1','URXMBP','URXMC1','URDUMMAL','SLD010H','LBXBMN','URXCNP','URXECP','URXMHH','URXMHP','URXMHNC','LBXV06','LBXV2A','LBXV3B','LBXV4C','LBXVCB','LBXVEB','LBXVCB','LBXVIPB','LBXVMC','LBXVOX','LBXVTC','LBXVTE','LBXVXY','URXUAS5','URXUAB','URXUAC','URXUMMA','URXUAS3','LBXBSE', 'RIAGENDR', 'RIDAGEYR', 'RIDRETH1', 'seqn', 'age_cat','ridreth1','ridreth3','edu_cat','cfastat','year','female','cerad_sum', # 'wtint2yr','wtmec2yr', 'BMXARML','BMXARMC','BMXHT','BMXLEG','BMXWAIST', 'INDFMPIR', 'DRABF', getNamesFromDataframe( 'DRQS',fdata), getNamesFromDataframe( 'DPD',fdata), getNamesFromDataframe( 'cfd',fdata), getNamesFromDataframe( 'z_',fdata), getNamesFromDataframe( 'low_',fdata), getNamesFromDataframe( 'sdm',fdata), # getNamesFromDataframe( 'DPQ',depression_data, exclusions=c('DPQ080','DPQ030''DPQ080',)), # getNamesFromDataframe( 'DPQ',depression_data, exclusions=c('DPQ100')), getNamesFromDataframe( 'URXUCR',fdata ), getNamesFromDataframe( 'BMXSAD',fdata ), getNamesFromDataframe( 'BPAEN',fdata ), getNamesFromDataframe( 'BPXP',fdata ), getNamesFromDataframe( 'DMD',fdata ), getNamesFromDataframe( 'DMDHHSZ',fdata ), getNamesFromDataframe( 'DRD',fdata ), getNamesFromDataframe( 'DBD',fdata ), #getNamesFromDataframe( 'DR1',fdata ), getNamesFromDataframe( 'WT',fdata ), getNamesFromDataframe( 'SDM',fdata ), getNamesFromDataframe( 'DMQ',fdata ), getNamesFromDataframe( 'FIA',fdata ), getNamesFromDataframe( 'MIA',fdata ), getNamesFromDataframe( 'AIA',fdata ), getNamesFromDataframe( 'DMDCIT',fdata ), getNamesFromDataframe( 'DMDYRS',fdata ), getNamesFromDataframe( 'RIDE',fdata ), getNamesFromDataframe( 'CFDCST',fdata ), getNamesFromDataframe( 'SDDSRVY', fdata ), getNamesFromDataframe( 'CFDCIT',fdata ), getNamesFromDataframe( 'LC',fdata ), getNamesFromDataframe( 'SI',fdata ) ) ) problematic_factors <- check_formula_factors(myformR, df) print(problematic_factors) ## character(0) idata2=impute_data(fdata ) # mdl = lm( myformR, data=idata2) # summary( mdl ) # mdl0 = lm( myformR, data=fdata) # summary( mdl0 ) ############## #### colcats=rep(\"Basic\",ncol(fdata)) colcats[ colnames(fdata) %in%  c(\"ridageyr\",\"riagendr\",\"race\",\"dmdeduc2\",\"INDFMPIR\") ]='demog' bpname=getNamesFromDataframe( \"BPX\",fdata) bmname=getNamesFromDataframe( \"BMX\",fdata) colcats[ colnames(fdata) %in%  c(bmname,bpname,\"Testosterone\",\"TotChol\",\"Diabetes\" ) ]='physical' colcats[ colnames(fdata) %in%   c(   getNamesFromDataframe( \"DPQ\", fdata ),    getNamesFromDataframe( \"SLQ\", fdata ) )  ]='mentalhealth' colcats[ colnames(fdata) %in%  getNamesFromDataframe( \"LBX\", fdata ) ]='exposures' colcats[ colnames(fdata) %in%  getNamesFromDataframe( \"DR1T\", fdata ) ]='diet' # colcats[ colnames(fdata) %in%  getNamesFromDataframe( \"cfd\", fdata )[-1] ]='digitspan' tbl=table(colcats) ############## nh_list=list() knm=names(tbl)[-1] mycc = complete.cases( fdata[ , colcats %in% knm ]) for ( k in knm ) {     print(k)     temp0=(fdata[mycc,colcats==k])     temp = data.frame(convert_to_numeric_matrix( temp0 ))     for ( j in 1:ncol(temp) ) {         hist( temp[,j], main=colnames(temp)[j]) #        Sys.sleep(1)         }     nh_list[[length(nh_list)+1]]=data.matrix( ( temp ) ) #    nh_list[[length(nh_list)]]=impute_and_report_na(nh_list[[length(nh_list)]] )     } ## [1] \"demog\" ## [1] \"diet\" ## [1] \"exposures\" ## [1] \"mentalhealth\" ## [1] \"physical\" names(nh_list)=knm ##### ################################################################################ regs <- regularizeSimlr(nh_list,fraction=0.15,sigma=rep(1.0,length(nh_list))) regs <- regularizeSimlr(nh_list) wdemog=which( knm == 'demog') regs[[ wdemog]]=diag( ncol(nh_list[[wdemog]])) initu=initializeSimlr( nh_list, k=min_columns_list(nh_list), jointReduction=TRUE ) resultNH <- simlr( nh_list,          iterations=300,         sparsenessQuantiles=rep(0.5,length(nh_list)),         positivities=rep(\"positive\",length(nh_list)),  #        energyType='regression', mixAlg='ica',         energyType='cca', mixAlg='pca',         scale=c(\"centerAndScale\", \"np\"), #        scale=c( \"robust\",  \"np\" ),         constraint=\"Grassmannx10x10\",         initialUMatrix=initu, verbose=T ) ## [1] \"Grassmann\" \"10\"        \"10\"        ## [1] \"     <0> BUILD-V <0> BUILD-V <0> BUILD-V <0> BUILD-V <0>    \" ## [1] \"initialDataTerm: 1.21946487899318  <o> mixer: pca  <o> E:  cca\" ## [1] \"Iteration: 1 bestEv: 0.61932734053793 bestIt: 1 CE: 0.61932734053793 featOrth: 0.0715750626425437\" ## [1] \"Iteration: 2 bestEv: 0.577544232613685 bestIt: 2 CE: 0.577544232613685 featOrth: 0.0669961577183825\" ## [1] \"Iteration: 3 bestEv: 0.535910687638303 bestIt: 3 CE: 0.535910687638303 featOrth: 0.062992404708655\" ## [1] \"Iteration: 4 bestEv: 0.421552500872032 bestIt: 4 CE: 0.421552500872032 featOrth: 0.050847382201307\" ## [1] \"Iteration: 5 bestEv: 0.382947025670519 bestIt: 5 CE: 0.382947025670519 featOrth: 0.0467064270190661\" ## [1] \"Iteration: 6 bestEv: 0.284493432058705 bestIt: 6 CE: 0.284493432058705 featOrth: 0.0359508062820522\" ## [1] \"Iteration: 7 bestEv: 0.155684357566727 bestIt: 7 CE: 0.155684357566727 featOrth: 0.0248506813685202\" ## [1] \"Iteration: 8 bestEv: 0.0829324949739227 bestIt: 8 CE: 0.0829324949739227 featOrth: 0.0191366886963609\" ## [1] \"Iteration: 9 bestEv: 0.0215930486755787 bestIt: 9 CE: 0.0215930486755787 featOrth: 0.0133772458052045\" ## [1] \"Iteration: 10 bestEv: -0.00606833727863338 bestIt: 10 CE: -0.00606833727863338 featOrth: 0.00935360378073757\" ## [1] \"Iteration: 11 bestEv: -0.00606833727863344 bestIt: 11 CE: -0.00606833727863345 featOrth: 0.00935360378073757\" ## [1] \"Iteration: 12 bestEv: -0.00606833727863344 bestIt: 11 CE: -0.00606833727863345 featOrth: 0.00935360378073757\" ## [1] \"Iteration: 13 bestEv: -0.00606833727863344 bestIt: 11 CE: -0.00606833727863345 featOrth: 0.00935360378073757\" ## [1] \"Iteration: 14 bestEv: -0.00606833727863344 bestIt: 11 CE: -0.00606833727863345 featOrth: 0.00935360378073757\" ## [1] \"Iteration: 15 bestEv: -0.00606833727863344 bestIt: 11 CE: -0.00606833727863345 featOrth: 0.00935360378073757\" ## [1] \"Iteration: 16 bestEv: -0.00606833727863344 bestIt: 11 CE: -0.00606833727863345 featOrth: 0.00935360378073757\" ## [1] \"Iteration: 17 bestEv: -0.00606833727863344 bestIt: 11 CE: -0.00606833727863345 featOrth: 0.00935360378073757\" ##################################################### projlist=list() mysimk=2 for ( k in 1:length(nh_list)) {     rownames(resultNH$v[[k]])=colnames( nh_list[[k]])     ux=data.frame(nh_list[[k]] %*% abs(resultNH$v[[k]][,1:mysimk]))     colnames(ux)=paste0(names(nh_list)[k],1:ncol(ux))     projlist[[length(projlist)+1]]=ux } simdf=simdf2=dplyr::bind_cols(projlist) cognames=c(\"cerad_sum\",\"cfdast\",\"cfdds\") cognames = c(   \"z_cerad_re\", \"z_animal_re\",     \"z_digit_re\",      \"z_delayed_re\",    \"z_global_re\" #  \"z_cerad_age\", \"z_animal_age\",     \"z_digit_age\",      \"z_delayed_age\",    \"z_global_age\", #  \"z_cerad_edu\", \"z_animal_edu\",     \"z_digit_edu\",      \"z_delayed_edu\",    \"z_global_edu\" ) simdf2[,cognames]=fdata[mycc,cognames] for ( kk in 1:length(cognames)) {   myform = paste0( cognames[kk],\" ~ \",paste0( colnames(simdf), collapse='+'))   mdl = lm( myform, data=simdf2 )   print( summary( mdl ) )   print( cognames[kk])   Sys.sleep(3) } ##  ## Call: ## lm(formula = myform, data = simdf2) ##  ## Residuals: ##      Min       1Q   Median       3Q      Max  ## -2.97408 -0.60523  0.04132  0.63516  2.21646  ##  ## Coefficients: ##                 Estimate Std. Error t value Pr(>|t|)     ## (Intercept)   -1.392e+00  5.887e-01  -2.365 0.018253 *   ## demog1        -3.158e+00  6.678e-01  -4.729 2.64e-06 *** ## demog2         1.166e+01  6.175e+00   1.888 0.059406 .   ## diet1          4.152e-04  1.194e-04   3.477 0.000533 *** ## diet2         -1.047e-05  6.531e-06  -1.603 0.109196     ## exposures1     3.763e-03  1.588e-02   0.237 0.812742     ## exposures2     5.730e-02  1.926e-02   2.975 0.003009 **  ## mentalhealth1 -3.873e-01  2.107e-01  -1.838 0.066404 .   ## mentalhealth2 -5.555e-01  5.998e-01  -0.926 0.354621     ## physical1      6.022e-02  3.386e-02   1.778 0.075698 .   ## physical2      1.034e-02  2.999e-02   0.345 0.730317     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ##  ## Residual standard error: 0.9023 on 858 degrees of freedom ##   (12 observations deleted due to missingness) ## Multiple R-squared:  0.06848,    Adjusted R-squared:  0.05762  ## F-statistic: 6.307 on 10 and 858 DF,  p-value: 2.2e-09 ##  ## [1] \"z_cerad_re\" ##  ## Call: ## lm(formula = myform, data = simdf2) ##  ## Residuals: ##     Min      1Q  Median      3Q     Max  ## -2.5675 -0.6986 -0.0804  0.6356  3.6167  ##  ## Coefficients: ##                 Estimate Std. Error t value Pr(>|t|)     ## (Intercept)   -2.235e+00  6.503e-01  -3.437 0.000617 *** ## demog1        -2.718e-05  7.402e-01   0.000 0.999971     ## demog2        -3.042e+00  6.817e+00  -0.446 0.655530     ## diet1          3.561e-04  1.330e-04   2.678 0.007557 **  ## diet2         -6.351e-06  7.714e-06  -0.823 0.410544     ## exposures1    -8.728e-03  1.750e-02  -0.499 0.618197     ## exposures2     3.901e-02  2.123e-02   1.837 0.066507 .   ## mentalhealth1 -4.766e-01  2.324e-01  -2.051 0.040592 *   ## mentalhealth2 -8.675e-01  6.625e-01  -1.309 0.190726     ## physical1      9.117e-02  3.727e-02   2.446 0.014639 *   ## physical2      9.746e-03  3.296e-02   0.296 0.767530     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ##  ## Residual standard error: 0.9912 on 850 degrees of freedom ##   (20 observations deleted due to missingness) ## Multiple R-squared:  0.05437,    Adjusted R-squared:  0.04324  ## F-statistic: 4.887 on 10 and 850 DF,  p-value: 6.932e-07 ##  ## [1] \"z_animal_re\" ##  ## Call: ## lm(formula = myform, data = simdf2) ##  ## Residuals: ##      Min       1Q   Median       3Q      Max  ## -2.68666 -0.70897 -0.06095  0.66542  2.69719  ##  ## Coefficients: ##                 Estimate Std. Error t value Pr(>|t|)     ## (Intercept)   -2.757e+00  6.221e-01  -4.431 1.06e-05 *** ## demog1        -2.479e+00  7.068e-01  -3.508 0.000474 *** ## demog2         7.806e+00  6.552e+00   1.191 0.233867     ## diet1          2.990e-04  1.265e-04   2.364 0.018314 *   ## diet2          4.810e-06  6.949e-06   0.692 0.488964     ## exposures1     2.492e-02  1.684e-02   1.480 0.139260     ## exposures2     7.444e-02  2.053e-02   3.627 0.000304 *** ## mentalhealth1 -7.919e-01  2.234e-01  -3.544 0.000415 *** ## mentalhealth2 -5.098e-01  6.381e-01  -0.799 0.424500     ## physical1      1.285e-01  3.574e-02   3.597 0.000340 *** ## physical2     -4.170e-03  3.186e-02  -0.131 0.895919     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ##  ## Residual standard error: 0.9639 on 870 degrees of freedom ## Multiple R-squared:  0.07519,    Adjusted R-squared:  0.06456  ## F-statistic: 7.073 on 10 and 870 DF,  p-value: 9.364e-11 ##  ## [1] \"z_digit_re\" ##  ## Call: ## lm(formula = myform, data = simdf2) ##  ## Residuals: ##     Min      1Q  Median      3Q     Max  ## -2.7968 -0.6182  0.0582  0.6831  1.9001  ##  ## Coefficients: ##                 Estimate Std. Error t value Pr(>|t|)     ## (Intercept)   -2.163e+00  6.047e-01  -3.578 0.000366 *** ## demog1        -3.193e+00  6.853e-01  -4.659 3.68e-06 *** ## demog2         1.245e+01  6.334e+00   1.965 0.049742 *   ## diet1          2.929e-04  1.227e-04   2.388 0.017156 *   ## diet2         -8.077e-06  6.709e-06  -1.204 0.228929     ## exposures1     7.228e-03  1.631e-02   0.443 0.657778     ## exposures2     4.712e-02  1.978e-02   2.382 0.017423 *   ## mentalhealth1 -1.845e-01  2.156e-01  -0.856 0.392407     ## mentalhealth2 -4.877e-01  6.161e-01  -0.792 0.428744     ## physical1      7.797e-02  3.478e-02   2.242 0.025200 *   ## physical2      3.227e-02  3.080e-02   1.048 0.295143     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ##  ## Residual standard error: 0.9268 on 859 degrees of freedom ##   (11 observations deleted due to missingness) ## Multiple R-squared:  0.05448,    Adjusted R-squared:  0.04347  ## F-statistic: 4.949 on 10 and 859 DF,  p-value: 5.378e-07 ##  ## [1] \"z_delayed_re\" ##  ## Call: ## lm(formula = myform, data = simdf2) ##  ## Residuals: ##    Min     1Q Median     3Q    Max  ## -6.253 -1.619 -0.042  1.580  7.514  ##  ## Coefficients: ##                 Estimate Std. Error t value Pr(>|t|)     ## (Intercept)   -6.277e+00  1.491e+00  -4.210 2.83e-05 *** ## demog1        -5.341e+00  1.697e+00  -3.147 0.001708 **  ## demog2         1.509e+01  1.564e+01   0.965 0.334941     ## diet1          9.409e-04  3.049e-04   3.086 0.002095 **  ## diet2         -1.156e-06  1.767e-05  -0.065 0.947864     ## exposures1     2.311e-02  4.029e-02   0.574 0.566420     ## exposures2     1.709e-01  4.867e-02   3.511 0.000469 *** ## mentalhealth1 -1.574e+00  5.351e-01  -2.942 0.003346 **  ## mentalhealth2 -2.131e+00  1.519e+00  -1.403 0.160919     ## physical1      2.850e-01  8.568e-02   3.326 0.000918 *** ## physical2      6.375e-03  7.568e-02   0.084 0.932893     ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ##  ## Residual standard error: 2.27 on 846 degrees of freedom ##   (24 observations deleted due to missingness) ## Multiple R-squared:  0.0723, Adjusted R-squared:  0.06134  ## F-statistic: 6.594 on 10 and 846 DF,  p-value: 6.9e-10 ##  ## [1] \"z_global_re\" ####################### for ( k in knm ) {   print(k)   print( interpret_simlr_vector2( resultNH$v[[k]], 1, n2show=3, shortnames=F ) )   print( interpret_simlr_vector2( resultNH$v[[k]], 2, n2show=3, shortnames=F ) ) } ## [1] \"demog\" ## riagendr_1     race_2 riagendr_2  ## 1.00000000 0.29547397 0.08087938  ## riagendr_1     race_2     race_3  ##  1.0000000  0.8748512  0.1431901  ## [1] \"diet\" ##  DR1TM161  DR1TMFAT  DR1TM181  ## 1.0000000 0.8493282 0.8250955  ##  DR1TLYCO  DR1TSODI    DR1TVC  ## 1.0000000 0.1927694 0.1603342  ## [1] \"exposures\" ##     LBXBMN     LBXIHG     LBXBCD  ## 1.00000000 0.14145834 0.04121102  ##    LBXTHG    LBXBGM    LBXIHG  ## 1.0000000 0.9415720 0.9369719  ## [1] \"mentalhealth\" ##    DPQ020    DPQ070    DPQ080  ## 1.0000000 0.8886414 0.3058964  ##    DPQ090    DPQ040    DPQ030  ## 1.0000000 0.7109818 0.3758003  ## [1] \"physical\" ##    BMXLEG     BMXHT   BMXARML  ## 1.0000000 0.8440892 0.4431668  ##           BMXARML BPXPULS_Irregular            BPXDI1  ##         1.0000000         0.3520253         0.3507924 ########################################################################################## # https://wwwn.cdc.gov/nchs/nhanes/search/default.aspx # > interpret_simlr_vector2( resultNH$v[['exposures']], 1, n2show=5, shortnames=F ) #   LBXVBZ    LBXVOX    LBXVFN    LBX2DF  # benzene, Xylene, furan, Dimethylfuran # 1.0000000 0.3346728 0.1868323 0.0586727  ########################################################################################## ###"},{"path":"https://github.com/stnava/simlr_nhanes/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Brian Avants. Maintainer.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"c, \"Avants\", role=c, ) e (2025). simlr.nhanes: SiMLR example using NHANES data. R package version 1.0.0, https://github.com/stnava/simlr_nhanes.","code":"@Manual{,   title = {simlr.nhanes: SiMLR example using NHANES data},   author = {{c} and {\"Avants\"} and {role=c} and email=\"stnava@gmail.com\") )},   year = {2025},   note = {R package version 1.0.0},   url = {https://github.com/stnava/simlr_nhanes}, }"},{"path":"https://github.com/stnava/simlr_nhanes/index.html","id":"simlr_nhanes","dir":"","previous_headings":"","what":"Helper package for simlr NHANES example analyses","title":"Helper package for simlr NHANES example analyses","text":"documentation page ","code":""},{"path":"https://github.com/stnava/simlr_nhanes/index.html","id":"simlr-nhanes","dir":"","previous_headings":"","what":"SiMLR NHANES","title":"Helper package for simlr NHANES example analyses","text":"TODO Data sources: NHANES raw CAPRA curated data nhanesA Code sources: haven ","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/check_formula_factors.html","id":null,"dir":"Reference","previous_headings":"","what":"Check Formula Factors — check_formula_factors","title":"Check Formula Factors — check_formula_factors","text":"Identifies factor variables formula fewer two levels.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/check_formula_factors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check Formula Factors — check_formula_factors","text":"","code":"check_formula_factors(formula, dataframe)"},{"path":"https://github.com/stnava/simlr_nhanes/reference/check_formula_factors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check Formula Factors — check_formula_factors","text":"formula formula object. dataframe data frame containing variables formula.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/check_formula_factors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check Formula Factors — check_formula_factors","text":"vector factor variable names fewer two levels.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/check_formula_factors.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check Formula Factors — check_formula_factors","text":"","code":"check_formula_factors(mpg ~ cyl + gear, mtcars) #> character(0)"},{"path":"https://github.com/stnava/simlr_nhanes/reference/convert_to_numeric_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert Data Frame to Numeric Matrix — convert_to_numeric_matrix","title":"Convert Data Frame to Numeric Matrix — convert_to_numeric_matrix","text":"Converts data frame categorical numeric columns numeric matrix, using one-hot encoding categorical variables.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/convert_to_numeric_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert Data Frame to Numeric Matrix — convert_to_numeric_matrix","text":"","code":"convert_to_numeric_matrix(df)"},{"path":"https://github.com/stnava/simlr_nhanes/reference/convert_to_numeric_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert Data Frame to Numeric Matrix — convert_to_numeric_matrix","text":"df data frame.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/convert_to_numeric_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert Data Frame to Numeric Matrix — convert_to_numeric_matrix","text":"numeric matrix.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/convert_to_numeric_matrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert Data Frame to Numeric Matrix — convert_to_numeric_matrix","text":"","code":"df <- data.frame(a = c(1, 2), b = c(\"yes\", \"no\")) convert_to_numeric_matrix(df) #>      a b_no b_yes #> [1,] 1    0     1 #> [2,] 2    1     0"},{"path":"https://github.com/stnava/simlr_nhanes/reference/count_unique_values.html","id":null,"dir":"Reference","previous_headings":"","what":"Count Unique Values and Filter Columns — count_unique_values","title":"Count Unique Values and Filter Columns — count_unique_values","text":"Counts unique values column data frame retains columns exceeding specified threshold.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/count_unique_values.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Count Unique Values and Filter Columns — count_unique_values","text":"","code":"count_unique_values(df, threshold)"},{"path":"https://github.com/stnava/simlr_nhanes/reference/count_unique_values.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Count Unique Values and Filter Columns — count_unique_values","text":"df data frame. threshold integer specifying minimum number unique values retain column.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/count_unique_values.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Count Unique Values and Filter Columns — count_unique_values","text":"data frame filtered columns.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/count_unique_values.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Count Unique Values and Filter Columns — count_unique_values","text":"","code":"df <- data.frame(a = c(1, 1, 2), b = c(\"x\", \"y\", \"z\")) count_unique_values(df, 1) #> a : 2 unique values #> b : 3 unique values #>   a b #> 1 1 x #> 2 1 y #> 3 2 z"},{"path":"https://github.com/stnava/simlr_nhanes/reference/create_formula.html","id":null,"dir":"Reference","previous_headings":"","what":"Create Regression Formula — create_formula","title":"Create Regression Formula — create_formula","text":"Creates regression formula data frame, excluding specified columns.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/create_formula.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create Regression Formula — create_formula","text":"","code":"create_formula(dataframe, outcome, exclusions)"},{"path":"https://github.com/stnava/simlr_nhanes/reference/create_formula.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create Regression Formula — create_formula","text":"dataframe input data frame. outcome outcome variable. exclusions vector columns exclude formula.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/create_formula.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create Regression Formula — create_formula","text":"formula object regression.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/create_formula.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create Regression Formula — create_formula","text":"","code":"create_formula(mtcars, \"mpg\", exclusions = c(\"cyl\", \"gear\")) #> mpg ~ disp + hp + drat + wt + qsec + vs + am + carb #> <environment: 0x1192f9228>"},{"path":"https://github.com/stnava/simlr_nhanes/reference/filter_na_columns.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter Columns with High NA Percentage — filter_na_columns","title":"Filter Columns with High NA Percentage — filter_na_columns","text":"Filters columns data frame higher percentage NA values specified threshold.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/filter_na_columns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter Columns with High NA Percentage — filter_na_columns","text":"","code":"filter_na_columns(df, max_na_percent = 0.2)"},{"path":"https://github.com/stnava/simlr_nhanes/reference/filter_na_columns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter Columns with High NA Percentage — filter_na_columns","text":"df data frame. max_na_percent Maximum allowed proportion NA values per column. Default 0.2.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/filter_na_columns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter Columns with High NA Percentage — filter_na_columns","text":"data frame filtered columns.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/filter_na_columns.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter Columns with High NA Percentage — filter_na_columns","text":"","code":"filter_na_columns(data.frame(a = c(1, NA, 3), b = c(NA, NA, 3)), max_na_percent = 0.5) #>    a #> 1  1 #> 2 NA #> 3  3"},{"path":"https://github.com/stnava/simlr_nhanes/reference/impute_and_report_na.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute Missing Values and Report NA Counts — impute_and_report_na","title":"Impute Missing Values and Report NA Counts — impute_and_report_na","text":"function imputes missing values matrix column means reports count missing values per column.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/impute_and_report_na.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute Missing Values and Report NA Counts — impute_and_report_na","text":"","code":"impute_and_report_na(mat)"},{"path":"https://github.com/stnava/simlr_nhanes/reference/impute_and_report_na.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute Missing Values and Report NA Counts — impute_and_report_na","text":"mat numeric matrix.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/impute_and_report_na.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute Missing Values and Report NA Counts — impute_and_report_na","text":"matrix imputed values.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/impute_and_report_na.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute Missing Values and Report NA Counts — impute_and_report_na","text":"","code":"mat <- matrix(c(1, NA, 3, 4, 5, NA), ncol = 2) impute_and_report_na(mat) #> No missing values detected. #>      [,1] [,2] #> [1,]    1    4 #> [2,]   NA    5 #> [3,]    3   NA"},{"path":"https://github.com/stnava/simlr_nhanes/reference/impute_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Impute Missing Data — impute_data","title":"Impute Missing Data — impute_data","text":"Imputes missing values data frame. Numeric columns imputed median, categorical columns frequent category.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/impute_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Impute Missing Data — impute_data","text":"","code":"impute_data(df)"},{"path":"https://github.com/stnava/simlr_nhanes/reference/impute_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Impute Missing Data — impute_data","text":"df data frame missing values.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/impute_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Impute Missing Data — impute_data","text":"data frame imputed values.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/impute_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Impute Missing Data — impute_data","text":"","code":"impute_data(data.frame(a = c(1, NA, 3), b = c(\"x\", \"y\", NA))) #>   a b #> 1 1 x #> 2 2 y #> 3 3 x"},{"path":"https://github.com/stnava/simlr_nhanes/reference/map_freq_to_numeric.html","id":null,"dir":"Reference","previous_headings":"","what":"Map Frequency Categories to Numeric Values — map_freq_to_numeric","title":"Map Frequency Categories to Numeric Values — map_freq_to_numeric","text":"Maps specific frequency categories numeric values, error handling invalid categories.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/map_freq_to_numeric.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Map Frequency Categories to Numeric Values — map_freq_to_numeric","text":"","code":"map_freq_to_numeric(df, colname)"},{"path":"https://github.com/stnava/simlr_nhanes/reference/map_freq_to_numeric.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Map Frequency Categories to Numeric Values — map_freq_to_numeric","text":"df data frame containing column mapped. colname name column mapped.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/map_freq_to_numeric.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Map Frequency Categories to Numeric Values — map_freq_to_numeric","text":"numeric vector mapped values.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/map_freq_to_numeric.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Map Frequency Categories to Numeric Values — map_freq_to_numeric","text":"","code":"map_freq_to_numeric(data.frame(freq = c(\"Not at all\", \"Several days\")), \"freq\") #> [1] 0 1"},{"path":"https://github.com/stnava/simlr_nhanes/reference/matrix_from_latent.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a Matrix from a Latent Matrix with Added Noise — matrix_from_latent","title":"Generate a Matrix from a Latent Matrix with Added Noise — matrix_from_latent","text":"function generates new matrix applying random linear transformation given latent matrix adding Gaussian noise.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/matrix_from_latent.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a Matrix from a Latent Matrix with Added Noise — matrix_from_latent","text":"","code":"matrix_from_latent(latent_matrix, target_p, noise_sd = 0.3)"},{"path":"https://github.com/stnava/simlr_nhanes/reference/matrix_from_latent.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a Matrix from a Latent Matrix with Added Noise — matrix_from_latent","text":"latent_matrix numeric matrix representing latent structure (n x k). target_p integer specifying number columns output matrix. noise_sd numeric value indicating standard deviation Gaussian noise added. Default 0.3.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/matrix_from_latent.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a Matrix from a Latent Matrix with Added Noise — matrix_from_latent","text":"numeric matrix dimensions (n x target_p), generated latent matrix random linear transformation added Gaussian noise.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/matrix_from_latent.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a Matrix from a Latent Matrix with Added Noise — matrix_from_latent","text":"","code":"latent <- matrix(rnorm(20), nrow = 5, ncol = 4) generated_matrix <- matrix_from_latent(latent, target_p = 3, noise_sd = 0.2) print(generated_matrix) #>            [,1]        [,2]       [,3] #> [1,] -0.8420428 -2.26384990 -1.4360201 #> [2,] -1.4226564  0.01670062  2.9901238 #> [3,] -3.9410985 -6.29693119  4.4003814 #> [4,]  2.4102664  1.54497778 -0.5047176 #> [5,] -1.5365092  0.60855535  0.2409585"},{"path":"https://github.com/stnava/simlr_nhanes/reference/merge_same_type_columns.html","id":null,"dir":"Reference","previous_headings":"","what":"Merge Columns of the Same Type from Two Data Frames — merge_same_type_columns","title":"Merge Columns of the Same Type from Two Data Frames — merge_same_type_columns","text":"Merges columns type two data frames based common column names.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/merge_same_type_columns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Merge Columns of the Same Type from Two Data Frames — merge_same_type_columns","text":"","code":"merge_same_type_columns(df1, df2)"},{"path":"https://github.com/stnava/simlr_nhanes/reference/merge_same_type_columns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Merge Columns of the Same Type from Two Data Frames — merge_same_type_columns","text":"df1 First data frame. df2 Second data frame.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/merge_same_type_columns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Merge Columns of the Same Type from Two Data Frames — merge_same_type_columns","text":"merged data frame containing matching columns.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/merge_same_type_columns.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Merge Columns of the Same Type from Two Data Frames — merge_same_type_columns","text":"","code":"merge_same_type_columns(data.frame(a = 1:3), data.frame(a = 4:6)) #> Error in bind_rows(df1[, matching_columns, drop = FALSE], df2[, matching_columns,     drop = FALSE]): could not find function \"bind_rows\""},{"path":"https://github.com/stnava/simlr_nhanes/reference/min_columns_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the Minimum Number of Columns in a List of Matrices — min_columns_list","title":"Calculate the Minimum Number of Columns in a List of Matrices — min_columns_list","text":"function loops list matrices returns minimum number columns found across matrices list.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/min_columns_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the Minimum Number of Columns in a List of Matrices — min_columns_list","text":"","code":"min_columns_list(matrix_list)"},{"path":"https://github.com/stnava/simlr_nhanes/reference/min_columns_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the Minimum Number of Columns in a List of Matrices — min_columns_list","text":"matrix_list list containing matrices. Non-matrix elements ignored warning.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/min_columns_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the Minimum Number of Columns in a List of Matrices — min_columns_list","text":"integer representing minimum number columns across matrices list.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/min_columns_list.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the Minimum Number of Columns in a List of Matrices — min_columns_list","text":"","code":"mat1 <- matrix(1:6, nrow = 2) mat2 <- matrix(1:12, nrow = 3) mat3 <- matrix(1:4, nrow = 2) min_columns_list(list(mat1, mat2, mat3)) # Returns 2 #> [1] 2"},{"path":"https://github.com/stnava/simlr_nhanes/reference/nhanescog.html","id":null,"dir":"Reference","previous_headings":"","what":"NHANES cognition data — nhanescog","title":"NHANES cognition data — nhanescog","text":"NHANES cognition data","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/nhanescog.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"NHANES cognition data — nhanescog","text":"","code":"nhanescog"},{"path":"https://github.com/stnava/simlr_nhanes/reference/nhanescog.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"NHANES cognition data — nhanescog","text":"Curated nhanes cognition data CAPRA","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/nhanescog.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"NHANES cognition data — nhanescog","text":"","code":"if (FALSE) { # \\dontrun{  data(\"nhanescog_2011_2014\") } # }"},{"path":"https://github.com/stnava/simlr_nhanes/reference/read_and_filter_xpt.html","id":null,"dir":"Reference","previous_headings":"","what":"Read and Filter XPT File — read_and_filter_xpt","title":"Read and Filter XPT File — read_and_filter_xpt","text":"Reads XPT file, converts data frame, renames first column \"ID\", filters based unique value counts.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/read_and_filter_xpt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read and Filter XPT File — read_and_filter_xpt","text":"","code":"read_and_filter_xpt(file_path, threshold = 100)"},{"path":"https://github.com/stnava/simlr_nhanes/reference/read_and_filter_xpt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read and Filter XPT File — read_and_filter_xpt","text":"file_path Path XPT file. threshold Numeric threshold filter columns based unique value counts. Default 100.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/read_and_filter_xpt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read and Filter XPT File — read_and_filter_xpt","text":"data frame filtered columns.","code":""},{"path":"https://github.com/stnava/simlr_nhanes/reference/read_and_filter_xpt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read and Filter XPT File — read_and_filter_xpt","text":"","code":"read_and_filter_xpt(\"data.xpt\", threshold = 50) #> Error in read_xpt(file_path): could not find function \"read_xpt\""}]
