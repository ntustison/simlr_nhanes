<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Integrative Analysis of NHANES Data Using Similarity-Driven Multi-View Learning (SiMLR) for Cognitive Health Prediction • simlr.nhanes</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Integrative Analysis of NHANES Data Using Similarity-Driven Multi-View Learning (SiMLR) for Cognitive Health Prediction">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">simlr.nhanes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/pca_cca_simlr.html">PCA, CCA and SiMLR: simple examples from simulated data</a></li>
    <li><a class="dropdown-item" href="../articles/simlr_nhanes.html">Integrative Analysis of NHANES Data Using Similarity-Driven Multi-View Learning (SiMLR) for Cognitive Health Prediction</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/stnava/simlr_nhanes/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Integrative Analysis of NHANES Data Using Similarity-Driven Multi-View Learning (SiMLR) for Cognitive Health Prediction</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/stnava/simlr_nhanes/blob/HEAD/vignettes/simlr_nhanes.Rmd"><code>vignettes/simlr_nhanes.Rmd</code></a></small>
      <div class="d-none name"><code>simlr_nhanes.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>Cognitive decline and disorders such as dementia and mild cognitive
impairment (MCI) are influenced by a variety of factors, including
demographic, dietary, physical, mental, and environmental components
(Livingston et al., 2020). Traditional statistical approaches often
analyze these factors in isolation, potentially missing key interactions
between predictors that jointly contribute to cognitive outcomes (James
et al., 2013). Machine learning and data-driven dimensionality reduction
methods provide a means to integrate multimodal data for improved
prediction accuracy (Kline et al. 2022).</p>
<p>Similarity-driven Multi-view Linear Reconstruction (or learning)
(SiMLR) is a novel approach designed to extract a unified
low-dimensional representation from heterogeneous data sources (Avants
et al., 2022). Unlike conventional factor analysis or principal
component analysis (PCA), SiMLR preserves local relationships within
each data modality while optimizing joint structure across multiple
sources. This study applies SiMLR to the National Health and Nutrition
Examination Survey (NHANES) dataset to assess whether a joint
representation of demographic, dietary, physical health, mental health,
and environmental factors can enhance the prediction of cognitive
outcomes.</p>
</div>
<div class="section level3">
<h3 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h3>
<div class="section level4">
<h4 id="data-and-preprocessing">Data and preprocessing<a class="anchor" aria-label="anchor" href="#data-and-preprocessing"></a>
</h4>
<p>Data were obtained from <a href="https://wwwn.cdc.gov/nchs/nhanes/Default.aspx" class="external-link">NHANES</a>, a
nationally representative dataset containing health and nutritional
information for the U.S. population. The <code>nhanesA</code> package in
R was used to retrieve and merge multiple datasets, ensuring consistency
in subject selection. Data modalities included:</p>
<ul>
<li><p><strong>Demographics</strong> (age, sex, educational
attainment)</p></li>
<li><p><strong>Dietary intake</strong> (nutrient consumption, caloric
intake)</p></li>
<li><p><strong>Physical health</strong> (blood pressure, body mass
index)</p></li>
<li><p><strong>Mental health</strong> (Patient Health Questionnaire-9
scores)</p></li>
<li><p><strong>Environmental exposure</strong> (metals and toxin
levels)</p></li>
</ul>
<p>Subjects with missing data exceeding a given % of their total feature
set were excluded to ensure robustness in model training. Continuous
variables were normalized to a standard scale, and categorical variables
were one-hot encoded. Half-percent winsorization was applied before
regression to further limit the impact of outlying data points.</p>
</div>
<div class="section level4">
<h4 id="simlr-implementation">SiMLR Implementation<a class="anchor" aria-label="anchor" href="#simlr-implementation"></a>
</h4>
<p>These are combined into SiMLR for an unsupervised dimensionality
reduction. The resulting low-dimensional representations are used for
joint prediction of cognitive outcomes. Over 2000 subjects with these
measurements are available along with environmental exposures in a large
majority of these
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>&gt;</mo><annotation encoding="application/x-tex">&gt;</annotation></semantics></math>
1400).</p>
<p>SiMLR was applied to the combined dataset to generate a
low-dimensional representation of the subjects. The method preserves
structure within each domain while optimizing for cross-domain
similarity, ensuring that interdependencies between different health
factors are retained. This representation was then used as input for a
cognitive outcome prediction model, where cognitive scores were derived
from standardized NHANES cognitive tests.</p>
<p>We predict the variable <code>z_digit_re</code> in NHANES which
refers to the Digit Symbol Substitution Test (DSST), a cognitive
assessment tool. The DSST evaluates processing speed, sustained
attention, and working memory by requiring participants to match symbols
with corresponding numbers under time constraints. The predictive
performance of SiMLR embeddings was compared to individual domain-based
models using mean squared error (MSE) and R-squared (ℓ²) statistics.</p>
</div>
</div>
<div class="section level3">
<h3 id="discussion">Discussion<a class="anchor" aria-label="anchor" href="#discussion"></a>
</h3>
<p>SiMLR identifies predictors from diet, physical measurements,
environmental exposures and mental health that jointly relate to DSST
and related variables. This example builds on prior work such as <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC10093810/" class="external-link">this</a> and
<a href="https://www.nature.com/articles/s41598-025-87384-y" class="external-link">this</a>
and <a href="https://scholar.google.com/scholar?hl=en&amp;as_sdt=0%2C33&amp;q=NHANES+cognition+exposures+diet+&amp;btnG=" class="external-link">many
others</a>.</p>
<p>Traditional models often treat predictors of cognition as independent
variables, failing to capture the complex interactions between different
health determinants. The results of this study support the hypothesis
that cognitive outcomes are best predicted using a <em>joint</em>
representation that integrates multiple health factors. SiMLR-based
embeddings consistently outperformed models trained on individual
domains, demonstrating that cognition is influenced by an interplay of
demographic, nutritional, physiological, psychological, and
environmental components.</p>
<p>One potential explanation for this finding is that cognitive
resilience and decline arise from a confluence of risk and protective
factors (Stern et al., 2019). For instance, environmental toxin exposure
might interact with dietary deficiencies to exacerbate cognitive
decline, while physical health metrics may moderate these effects. By
leveraging SiMLR, we capture these interdependencies in a manner that
traditional regression models cannot.</p>
<p>These findings highlight the importance of multi-domain, integrative
approaches in cognitive health research. Future studies could extend
this framework by incorporating longitudinal NHANES data to assess how
joint representations evolve over time and influence cognitive
trajectories. Additionally, expanding SiMLR applications to other public
health datasets could refine our understanding of complex health
interactions and inform early intervention strategies for cognitive
disorders.</p>
</div>
<div class="section level2">
<h2 id="software-implementation">Software implementation<a class="anchor" aria-label="anchor" href="#software-implementation"></a>
</h2>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>Load the relevant libraries.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load necessary libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sinhrks/ggfortify" class="external-link">ggfortify</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dmurdoch/ellipse" class="external-link">ellipse</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'ellipse'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:graphics':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     pairs</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ANTsR</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: replacing previous import 'stats::filter' by 'dplyr::filter' when</span></span>
<span><span class="co">## loading 'ANTsR'</span></span></code></pre>
<pre><code><span><span class="co">## ANTsR 0.6.1</span></span>
<span><span class="co">## Environment variables set either in .Renviron or with a seed (e.g. XXX): </span></span>
<span><span class="co">## Sys.setenv(ANTS_RANDOM_SEED = XXX)</span></span>
<span><span class="co">## Sys.setenv(ITK_GLOBAL_DEFAULT_NUMBER_OF_THREADS = 1)</span></span>
<span><span class="co">## may influence reproducibility in some methods. See</span></span>
<span><span class="co">## https://github.com/ANTsX/ANTs/wiki/antsRegistration-reproducibility-issues</span></span>
<span><span class="co">## for more information.Also see *repro methods in antsRegistration.</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'ANTsR'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     sd, var</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     all, any, apply, max, min, prod, range, sum</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stnava/subtyper" class="external-link">subtyper</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: replacing previous import 'ciTools::add_ci' by 'gtsummary::add_ci'</span></span>
<span><span class="co">## when loading 'subtyper'</span></span></code></pre>
<pre><code><span><span class="co">## Warning: replacing previous import 'dplyr::as_data_frame' by</span></span>
<span><span class="co">## 'igraph::as_data_frame' when loading 'subtyper'</span></span></code></pre>
<pre><code><span><span class="co">## Warning: replacing previous import 'dplyr::groups' by 'igraph::groups' when</span></span>
<span><span class="co">## loading 'subtyper'</span></span></code></pre>
<pre><code><span><span class="co">## Warning: replacing previous import 'dplyr::union' by 'igraph::union' when</span></span>
<span><span class="co">## loading 'subtyper'</span></span></code></pre>
<pre><code><span><span class="co">## Warning: replacing previous import 'gtsummary::add_ci' by 'ciTools::add_ci'</span></span>
<span><span class="co">## when loading 'subtyper'</span></span></code></pre>
<pre><code><span><span class="co">## Registered S3 methods overwritten by 'fmsb':</span></span>
<span><span class="co">##   method    from</span></span>
<span><span class="co">##   print.roc pROC</span></span>
<span><span class="co">##   plot.roc  pROC</span></span></code></pre>
<pre><code><span><span class="co">## Warning: replacing previous import 'gt::gt' by 'globaltest::gt' when loading</span></span>
<span><span class="co">## 'subtyper'</span></span></code></pre>
<pre><code><span><span class="co">## Warning: replacing previous import 'dplyr::rename' by 'plyr::rename' when</span></span>
<span><span class="co">## loading 'subtyper'</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span> <span class="va"><a href="https://cran.r-project.org/package=nhanesA" class="external-link">nhanesA</a></span> <span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span> <span class="va"><a href="https://github.com/stnava/simlr_nhanes">simlr.nhanes</a></span> <span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span> <span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span> <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:Biobase':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     combine</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:BiocGenerics':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     combine, intersect, setdiff, union</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:gridExtra':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     combine</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ramnathv/htmlwidgets" class="external-link">htmlwidgets</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"nhanescog_2011_2014"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"nhanes_dict"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="nhanes-example">NHANES example<a class="anchor" aria-label="anchor" href="#nhanes-example"></a>
</h3>
<p>We download these data on the fly and merge them together using the
embedded data as well as the <code>nhanesA</code> package.</p>
<pre><code><span><span class="co">## simpleWarning in download.file(url, tf, mode = "wb", quiet = TRUE): downloaded length 0 != reported length 1245</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## simpleWarning in download.file(url, tf, mode = "wb", quiet = TRUE): downloaded length 0 != reported length 1245</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##   Male Female </span></span>
<span><span class="co">##   1469   1545</span></span></code></pre>
<p><img src="simlr_nhanes_files/figure-html/nhanes-1.png" width="700"><img src="simlr_nhanes_files/figure-html/nhanes-2.png" width="700"></p>
<pre><code><span><span class="co">## character(0)</span></span></code></pre>
<p>Define the categories of data so that these can be used to identify a
low-dimensional representation based on the SiMLR objective. We do not
use the cognitive data with which this embedding will be associated
later.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">####################################</span></span>
<span><span class="kw">if</span> <span class="op">(</span> <span class="cn">TRUE</span> <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fdatanum</span> <span class="op">=</span> <span class="fu"><a href="../reference/convert_to_numeric_matrix.html">convert_to_numeric_matrix</a></span><span class="op">(</span> <span class="va">fdata</span> <span class="op">)</span></span>
<span>  <span class="va">tarcols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">fdatanum</span><span class="op">)</span></span>
<span>  <span class="va">grepper</span> <span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/subtyper/man/multigrep.html" class="external-link">multigrep</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_NA"</span>,<span class="st">"limit"</span><span class="op">)</span>,<span class="va">tarcols</span><span class="op">)</span> </span>
<span>  <span class="va">fdatanum</span> <span class="op">=</span> <span class="va">fdatanum</span><span class="op">[</span> , <span class="op">-</span><span class="va">grepper</span><span class="op">]</span></span>
<span>  <span class="va">tarcols</span><span class="op">=</span><span class="va">tarcols</span><span class="op">[</span><span class="op">-</span><span class="va">grepper</span><span class="op">]</span></span>
<span>  <span class="va">fdatanum</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> <span class="op">(</span><span class="va">fdatanum</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">fdatanum</span><span class="op">)</span><span class="op">=</span><span class="va">tarcols</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">colcats</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Basic"</span>,<span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">fdatanum</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">colcats</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">fdatanum</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ridageyr"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/subtyper/man/getNamesFromDataframe.html" class="external-link">getNamesFromDataframe</a></span><span class="op">(</span><span class="st">"riagendr"</span>,<span class="va">fdatanum</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/subtyper/man/getNamesFromDataframe.html" class="external-link">getNamesFromDataframe</a></span><span class="op">(</span><span class="st">"race"</span>,<span class="va">fdatanum</span><span class="op">)</span>,</span>
<span>  <span class="st">"dmdeduc2"</span>,<span class="st">"INDFMPIR"</span><span class="op">)</span> <span class="op">]</span><span class="op">=</span><span class="st">'demog'</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bpname</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/subtyper/man/getNamesFromDataframe.html" class="external-link">getNamesFromDataframe</a></span><span class="op">(</span> <span class="st">"BPX"</span>,<span class="va">fdatanum</span><span class="op">)</span></span>
<span><span class="va">bmname</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/subtyper/man/getNamesFromDataframe.html" class="external-link">getNamesFromDataframe</a></span><span class="op">(</span> <span class="st">"BMX"</span>,<span class="va">fdatanum</span><span class="op">)</span></span>
<span><span class="va">colcats</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">fdatanum</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bmname</span>,<span class="va">bpname</span>,<span class="st">"Testosterone"</span>,<span class="st">"TotChol"</span>,<span class="st">"Diabetes"</span> <span class="op">)</span> <span class="op">]</span><span class="op">=</span><span class="st">'physical'</span></span>
<span><span class="va">colcats</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">fdatanum</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/subtyper/man/getNamesFromDataframe.html" class="external-link">getNamesFromDataframe</a></span><span class="op">(</span> <span class="st">"DPQ"</span>, <span class="va">fdatanum</span> <span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/subtyper/man/getNamesFromDataframe.html" class="external-link">getNamesFromDataframe</a></span><span class="op">(</span> <span class="st">"SLQ"</span>, <span class="va">fdatanum</span> <span class="op">)</span> <span class="op">)</span>  <span class="op">]</span><span class="op">=</span><span class="st">'mentalhealth'</span></span>
<span><span class="va">x</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'LC'</span>,<span class="st">'.x'</span>,<span class="st">'.y'</span>,<span class="st">'URDUMMAL'</span>,<span class="st">'LBXVDE'</span>,<span class="st">'LBX4CE'</span><span class="op">)</span></span>
<span><span class="va">colcats</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">fdatanum</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span>  <span class="fu"><a href="https://rdrr.io/pkg/subtyper/man/getNamesFromDataframe.html" class="external-link">getNamesFromDataframe</a></span><span class="op">(</span> <span class="st">"LBX"</span>, <span class="va">fdatanum</span>, exclusions<span class="op">=</span><span class="va">x</span> <span class="op">)</span> <span class="op">]</span><span class="op">=</span><span class="st">'exposures'</span></span>
<span><span class="va">colcats</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">fdatanum</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span>  <span class="fu"><a href="https://rdrr.io/pkg/subtyper/man/getNamesFromDataframe.html" class="external-link">getNamesFromDataframe</a></span><span class="op">(</span> <span class="st">"LBD"</span>, <span class="va">fdatanum</span>, exclusions<span class="op">=</span><span class="va">x</span> <span class="op">)</span> <span class="op">]</span><span class="op">=</span><span class="st">'exposures'</span></span>
<span><span class="va">colcats</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">fdatanum</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span>  <span class="fu"><a href="https://rdrr.io/pkg/subtyper/man/getNamesFromDataframe.html" class="external-link">getNamesFromDataframe</a></span><span class="op">(</span> <span class="st">"URX"</span>, <span class="va">fdatanum</span>, exclusions<span class="op">=</span><span class="va">x</span> <span class="op">)</span> <span class="op">]</span><span class="op">=</span><span class="st">'exposures'</span></span>
<span><span class="va">colcats</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">fdatanum</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span>  <span class="fu"><a href="https://rdrr.io/pkg/subtyper/man/getNamesFromDataframe.html" class="external-link">getNamesFromDataframe</a></span><span class="op">(</span> <span class="st">"URD"</span>, <span class="va">fdatanum</span>, exclusions<span class="op">=</span><span class="va">x</span> <span class="op">)</span> <span class="op">]</span><span class="op">=</span><span class="st">'exposures'</span></span>
<span><span class="va">colcats</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">fdatanum</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span>  <span class="fu"><a href="https://rdrr.io/pkg/subtyper/man/getNamesFromDataframe.html" class="external-link">getNamesFromDataframe</a></span><span class="op">(</span> <span class="st">"LBC"</span>, <span class="va">fdatanum</span>, exclusions<span class="op">=</span><span class="va">x</span> <span class="op">)</span> <span class="op">]</span><span class="op">=</span><span class="st">'exposures'</span></span>
<span><span class="va">colcats</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">fdatanum</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span>  <span class="fu"><a href="https://rdrr.io/pkg/subtyper/man/getNamesFromDataframe.html" class="external-link">getNamesFromDataframe</a></span><span class="op">(</span> <span class="st">"DR1T"</span>, <span class="va">fdatanum</span>, exclusions<span class="op">=</span><span class="st">'DR1TWS'</span> <span class="op">)</span> <span class="op">]</span><span class="op">=</span><span class="st">'diet'</span></span>
<span><span class="co"># colcats[ colnames(fdatanum) %in%  getNamesFromDataframe( "cfd", fdatanum )[-1] ]='digitspan'</span></span>
<span><span class="va">tbl</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">colcats</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span> <span class="va">nm</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">expmiss</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">fdatanum</span><span class="op">[</span> ,<span class="va">colcats</span> <span class="op">==</span> <span class="va">nm</span> <span class="op">]</span><span class="op">)</span> <span class="op">)</span></span>
<span>  <span class="va">colcats</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">fdatanum</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">expmiss</span><span class="op">)</span><span class="op">[</span> <span class="va">expmiss</span> <span class="op">&gt;</span> <span class="fl">800</span> <span class="op">]</span>  <span class="op">]</span> <span class="op">=</span> <span class="st">'Basic'</span></span>
<span>  <span class="op">}</span></span>
<span><span class="va">tbl</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">colcats</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##############</span></span>
<span><span class="va">nh_list</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">knm</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tbl</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">mycc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span> <span class="va">fdatanum</span><span class="op">[</span> , <span class="va">colcats</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">'demog'</span> <span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># mycc = !is.na(fdata$LBXTHG) # complete.cases( fdatanum[ , colcats %in% 'exposures' ])</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">mycc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## mycc</span></span>
<span><span class="co">## FALSE  TRUE </span></span>
<span><span class="co">##   210  2387</span></span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">doimp</span><span class="op">=</span><span class="cn">TRUE</span></span>
<span><span class="kw">for</span> <span class="op">(</span> <span class="va">k</span> <span class="kw">in</span> <span class="va">knm</span> <span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">k</span><span class="op">)</span></span>
<span>    <span class="va">temp0</span><span class="op">=</span><span class="op">(</span><span class="va">fdatanum</span><span class="op">[</span><span class="va">mycc</span>,<span class="va">colcats</span><span class="op">==</span><span class="va">k</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="../reference/convert_to_numeric_matrix.html">convert_to_numeric_matrix</a></span><span class="op">(</span> <span class="va">temp0</span> <span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">vv</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ANTsR/man/apply.html" class="external-link">apply</a></span><span class="op">(</span> <span class="va">temp</span>, <span class="fl">2</span>, FUN<span class="op">=</span><span class="va">var</span>, na.rm<span class="op">=</span><span class="cn">T</span> <span class="op">)</span></span>
<span>    <span class="va">temp</span> <span class="op">=</span> <span class="va">temp</span><span class="op">[</span> , <span class="va">vv</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">]</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span> <span class="va">k</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'exposures'</span>,<span class="st">'diet'</span><span class="op">)</span> <span class="op">|</span> <span class="cn">TRUE</span> <span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">nn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span>
<span>      <span class="kw">for</span> <span class="op">(</span>  <span class="va">jj</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">)</span> <span class="op">{</span> </span>
<span>        <span class="va">temp</span><span class="op">[</span> , <span class="va">nn</span><span class="op">[</span><span class="va">jj</span><span class="op">]</span> <span class="op">]</span> <span class="op">=</span> <span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/winsor.html" class="external-link">winsor</a></span><span class="op">(</span> <span class="va">temp</span><span class="op">[</span> , <span class="va">nn</span><span class="op">[</span><span class="va">jj</span><span class="op">]</span> <span class="op">]</span>, <span class="fl">0.005</span>, na.rm<span class="op">=</span><span class="cn">T</span> <span class="op">)</span></span>
<span>        <span class="va">temp</span><span class="op">[</span> , <span class="va">nn</span><span class="op">[</span><span class="va">jj</span><span class="op">]</span> <span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">temp</span><span class="op">[</span> , <span class="va">nn</span><span class="op">[</span><span class="va">jj</span><span class="op">]</span> <span class="op">]</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/ANTsR/man/antsImageSummary.html" class="external-link">min</a></span><span class="op">(</span><span class="va">temp</span><span class="op">[</span> , <span class="va">nn</span><span class="op">[</span><span class="va">jj</span><span class="op">]</span> <span class="op">]</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">=</span> <span class="va">nn</span></span>
<span>      <span class="va">vv</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ANTsR/man/apply.html" class="external-link">apply</a></span><span class="op">(</span> <span class="va">temp</span>, <span class="fl">2</span>, FUN<span class="op">=</span><span class="va">var</span>, na.rm<span class="op">=</span><span class="cn">T</span> <span class="op">)</span></span>
<span>      <span class="va">temp</span> <span class="op">=</span> <span class="va">temp</span><span class="op">[</span> , <span class="va">vv</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">]</span></span>
<span>      <span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="../reference/remove_perfectly_correlated.html">remove_perfectly_correlated</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> <span class="va">temp</span> <span class="op">)</span>, tolerance<span class="op">=</span><span class="fl">0.01</span> <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span> <span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">)</span> <span class="op">{</span></span>
<span><span class="co">#        hist( temp[,j], main=colnames(temp)[j])</span></span>
<span><span class="co">#        Sys.sleep(1)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="va">nh_list</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nh_list</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html" class="external-link">data.matrix</a></span><span class="op">(</span> <span class="op">(</span> <span class="va">temp</span> <span class="op">)</span> <span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">nh_list</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nh_list</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#    nh_list[[length(nh_list)]]=impute_and_report_na(nh_list[[length(nh_list)]] )</span></span>
<span>    <span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "demog"</span></span>
<span><span class="co">## [1] "ridageyr"   "dmdeduc2"   "INDFMPIR"   "riagendr_1" "race_1"    </span></span>
<span><span class="co">## [6] "race_2"     "race_3"     "race_4"    </span></span>
<span><span class="co">## [1] "diet"</span></span>
<span><span class="co">##  [1] "DR1TNUMF" "DR1TKCAL" "DR1TPROT" "DR1TCARB" "DR1TSUGR" "DR1TFIBE"</span></span>
<span><span class="co">##  [7] "DR1TTFAT" "DR1TSFAT" "DR1TMFAT" "DR1TPFAT" "DR1TCHOL" "DR1TATOC"</span></span>
<span><span class="co">## [13] "DR1TATOA" "DR1TRET"  "DR1TVARA" "DR1TACAR" "DR1TBCAR" "DR1TCRYP"</span></span>
<span><span class="co">## [19] "DR1TLYCO" "DR1TLZ"   "DR1TVB1"  "DR1TVB2"  "DR1TNIAC" "DR1TVB6" </span></span>
<span><span class="co">## [25] "DR1TFOLA" "DR1TFA"   "DR1TFF"   "DR1TFDFE" "DR1TCHL"  "DR1TVB12"</span></span>
<span><span class="co">## [31] "DR1TB12A" "DR1TVC"   "DR1TVD"   "DR1TVK"   "DR1TCALC" "DR1TPHOS"</span></span>
<span><span class="co">## [37] "DR1TMAGN" "DR1TIRON" "DR1TZINC" "DR1TCOPP" "DR1TSODI" "DR1TPOTA"</span></span>
<span><span class="co">## [43] "DR1TSELE" "DR1TCAFF" "DR1TTHEO" "DR1TALCO" "DR1TMOIS" "DR1TS040"</span></span>
<span><span class="co">## [49] "DR1TS060" "DR1TS080" "DR1TS100" "DR1TS120" "DR1TS140" "DR1TS160"</span></span>
<span><span class="co">## [55] "DR1TS180" "DR1TM161" "DR1TM201" "DR1TM221" "DR1TP183" "DR1TP184"</span></span>
<span><span class="co">## [61] "DR1TP204" "DR1TP205" "DR1TP225" "DR1TP226"</span></span>
<span><span class="co">## [1] "exposures"</span></span>
<span><span class="co">## [1] "LBXBPB" "LBXBCD" "LBXTHG" "LBXBSE" "LBXBMN" "LBXIHG" "LBXBGE" "LBXBGM"</span></span>
<span><span class="co">## [1] "mentalhealth"</span></span>
<span><span class="co">##  [1] "DPQ010" "DPQ020" "DPQ030" "DPQ040" "DPQ050" "DPQ060" "DPQ070" "DPQ080"</span></span>
<span><span class="co">##  [9] "DPQ090" "SLQ050" "SLQ060"</span></span>
<span><span class="co">## [1] "physical"</span></span>
<span><span class="co">##  [1] "BPXPLS"          "BPXML1"          "BPXSY1"          "BPXDI1"         </span></span>
<span><span class="co">##  [5] "BPXSY2"          "BPXDI2"          "BPXSY3"          "BPXDI3"         </span></span>
<span><span class="co">##  [9] "BMXWT"           "BMXHT"           "BMXBMI"          "BMXLEG"         </span></span>
<span><span class="co">## [13] "BMXARML"         "BMXARMC"         "BMXWAIST"        "BMXSAD1"        </span></span>
<span><span class="co">## [17] "BPXPULS_Regular"</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">nh_list</span><span class="op">)</span><span class="op">=</span><span class="va">knm</span></span>
<span><span class="co">#####</span></span></code></pre></div>
<p>Run the methods using reasonable defaults as recommended by prior
work.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">################################################################################</span></span>
<span><span class="co"># regs &lt;- regularizeSimlr(nh_list,fraction=0.15,sigma=rep(1.0,length(nh_list)))</span></span>
<span><span class="co">#</span></span>
<span><span class="va">regs</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">wdemog</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span> <span class="va">knm</span> <span class="op">==</span> <span class="st">'demog'</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span> <span class="va">wdemog</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nh_list</span><span class="op">)</span> <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">nh_list</span><span class="op">[[</span><span class="va">wdemog</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ANTsR/man/antsrimpute.html" class="external-link">antsrimpute</a></span><span class="op">(</span> <span class="va">nh_list</span><span class="op">[[</span><span class="va">wdemog</span><span class="op">]</span><span class="op">]</span> <span class="op">)</span></span>
<span>  <span class="va">regs</span><span class="op">[[</span> <span class="va">wdemog</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">nh_list</span><span class="op">[[</span><span class="va">wdemog</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">regs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ANTsR/man/regularizeSimlr.html" class="external-link">regularizeSimlr</a></span><span class="op">(</span><span class="va">nh_list</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span> <span class="va">wdemog</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">regs</span><span class="op">)</span> <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span> <span class="va">regs</span><span class="op">[[</span><span class="va">wdemog</span><span class="op">]</span><span class="op">]</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Regularization: "</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">regs</span><span class="op">)</span><span class="op">[</span><span class="va">wdemog</span><span class="op">]</span> <span class="op">)</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="simlr_nhanes_files/figure-html/nhanessimlrrun-1.png" width="700"><img src="simlr_nhanes_files/figure-html/nhanessimlrrun-2.png" width="700"><img src="simlr_nhanes_files/figure-html/nhanessimlrrun-3.png" width="700"><img src="simlr_nhanes_files/figure-html/nhanessimlrrun-4.png" width="700"><img src="simlr_nhanes_files/figure-html/nhanessimlrrun-5.png" width="700"></p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span> <span class="va">regs</span> <span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">nh_list</span><span class="op">)</span></span>
<span><span class="co"># initu=initializeSimlr( nh_list, k=round(max_columns_list(nh_list)), jointReduction=TRUE )</span></span>
<span><span class="va">initu</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ANTsR/man/initializeSimlr.html" class="external-link">initializeSimlr</a></span><span class="op">(</span> <span class="va">nh_list</span>, k<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/max_columns_list.html">max_columns_list</a></span><span class="op">(</span><span class="va">nh_list</span><span class="op">)</span><span class="op">*</span><span class="fl">0.8</span><span class="op">)</span>, jointReduction<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span></span>
<span><span class="co">########################### ########################### </span></span>
<span><span class="va">mysigns</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"positive"</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nh_list</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mysigns</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">nh_list</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'exposures'</span>,<span class="st">'diet'</span><span class="op">)</span> <span class="op">]</span><span class="op">=</span><span class="st">'either'</span></span>
<span><span class="va">params</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="va">params</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'cca'</span>,<span class="st">'pca'</span><span class="op">)</span></span>
<span><span class="va">params</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'centerAndScale'</span>,<span class="st">'np'</span><span class="op">)</span></span>
<span><span class="va">params</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">params</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'regression'</span>,<span class="st">'ica'</span><span class="op">)</span></span>
<span><span class="va">params</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'centerAndScale'</span>,<span class="st">'np'</span><span class="op">)</span></span>
<span><span class="va">pindex</span> <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="va">ofn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"_simlr_"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">params</span><span class="op">[[</span><span class="va">pindex</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,collapse<span class="op">=</span><span class="st">"_"</span><span class="op">)</span>, <span class="st">"_"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">params</span><span class="op">[[</span><span class="va">pindex</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,collapse<span class="op">=</span><span class="st">"_"</span><span class="op">)</span>,</span>
<span>    collapse<span class="op">=</span><span class="st">'_'</span> <span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span> <span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"resultNH"</span><span class="op">)</span> <span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">resultNH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ANTsR/man/simlr.html" class="external-link">simlr</a></span><span class="op">(</span> <span class="va">nh_list</span>, </span>
<span>        iterations<span class="op">=</span><span class="fl">100</span>,</span>
<span>        sparsenessQuantiles<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nh_list</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        positivities<span class="op">=</span><span class="va">mysigns</span>, </span>
<span>        energyType<span class="op">=</span><span class="va">params</span><span class="op">[[</span><span class="va">pindex</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, mixAlg<span class="op">=</span><span class="va">params</span><span class="op">[[</span><span class="va">pindex</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>        scale<span class="op">=</span><span class="va">params</span><span class="op">[[</span><span class="va">pindex</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,</span>
<span>        constraint<span class="op">=</span><span class="st">"Stiefelx10x10"</span>,</span>
<span>        randomSeed<span class="op">=</span><span class="fl">99</span>,</span>
<span>        initialUMatrix<span class="op">=</span><span class="va">initu</span>, verbose<span class="op">=</span><span class="cn">T</span> <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/ANTsR/man/write_simlr_data_frames.html" class="external-link">write_simlr_data_frames</a></span><span class="op">(</span> <span class="va">resultNH</span><span class="op">$</span><span class="va">v</span>,  <span class="va">ofn</span> <span class="op">)</span></span>
<span>  <span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Stiefel" "10"      "10"     </span></span>
<span><span class="co">## [1] "     &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt; BUILD-V &lt;0&gt;    "</span></span>
<span><span class="co">## [1] "initialDataTerm: 2.13658793844291  &lt;o&gt; mixer: ica  &lt;o&gt; E:  regression"</span></span>
<span><span class="co">## [1] "Iteration: 1 bestEv: 12.1717021179274 bestIt: 1 CE: 12.1717021179274 featOrth: 0.122725547685486"</span></span>
<span><span class="co">## [1] "Iteration: 2 bestEv: 1.66383281752505 bestIt: 2 CE: 1.66383281752505 featOrth: 0.113166448355752"</span></span>
<span><span class="co">## [1] "Iteration: 3 bestEv: 1.0732734040137 bestIt: 3 CE: 1.0732734040137 featOrth: 0.100622659778029"</span></span>
<span><span class="co">## [1] "Iteration: 4 bestEv: 0.967835507966887 bestIt: 4 CE: 0.967835507966887 featOrth: 0.0964059269576375"</span></span>
<span><span class="co">## [1] "Iteration: 5 bestEv: 0.967835507966887 bestIt: 4 CE: 1.20587499732282 featOrth: 0.0936654406938453"</span></span>
<span><span class="co">## [1] "Iteration: 6 bestEv: 0.895185571366584 bestIt: 6 CE: 0.895185571366584 featOrth: 0.0892975816955082"</span></span>
<span><span class="co">## [1] "Iteration: 7 bestEv: 0.895185571366584 bestIt: 6 CE: 1.06726678070809 featOrth: 0.0844445381905825"</span></span>
<span><span class="co">## [1] "Iteration: 8 bestEv: 0.817313451230316 bestIt: 8 CE: 0.817313451230317 featOrth: 0.0812721336740814"</span></span>
<span><span class="co">## [1] "Iteration: 9 bestEv: 0.771184361134418 bestIt: 9 CE: 0.771184361134418 featOrth: 0.0769270577734492"</span></span>
<span><span class="co">## [1] "Iteration: 10 bestEv: 0.743485796202322 bestIt: 10 CE: 0.743485796202322 featOrth: 0.0740219300599754"</span></span>
<span><span class="co">## [1] "Iteration: 11 bestEv: 0.73004121449832 bestIt: 11 CE: 0.73004121449832 featOrth: 0.0721001954730243"</span></span>
<span><span class="co">## [1] "Iteration: 12 bestEv: 0.707963871631968 bestIt: 12 CE: 0.707963871631968 featOrth: 0.0701969579173934"</span></span>
<span><span class="co">## [1] "Iteration: 13 bestEv: 0.707963871631968 bestIt: 12 CE: 0.886901038227124 featOrth: 0.065481230808956"</span></span>
<span><span class="co">## [1] "Iteration: 14 bestEv: 0.651937352827164 bestIt: 14 CE: 0.651937352827164 featOrth: 0.064454757788778"</span></span>
<span><span class="co">## [1] "Iteration: 15 bestEv: 0.585987333090474 bestIt: 15 CE: 0.585987333090474 featOrth: 0.0576425657094385"</span></span>
<span><span class="co">## [1] "Iteration: 16 bestEv: 0.58476729305694 bestIt: 16 CE: 0.58476729305694 featOrth: 0.0575296881623407"</span></span>
<span><span class="co">## [1] "Iteration: 17 bestEv: 0.58476729305694 bestIt: 16 CE: 0.799175126667505 featOrth: 0.0570081034877741"</span></span>
<span><span class="co">## [1] "Iteration: 18 bestEv: 0.558606661828871 bestIt: 18 CE: 0.558606661828871 featOrth: 0.0551832564357988"</span></span>
<span><span class="co">## [1] "Iteration: 19 bestEv: 0.55025662840197 bestIt: 19 CE: 0.55025662840197 featOrth: 0.0531474114190072"</span></span>
<span><span class="co">## [1] "Iteration: 20 bestEv: 0.476220584995957 bestIt: 20 CE: 0.476220584995957 featOrth: 0.0457841279086238"</span></span>
<span><span class="co">## [1] "Iteration: 21 bestEv: 0.45101593618303 bestIt: 21 CE: 0.45101593618303 featOrth: 0.0441788673801948"</span></span>
<span><span class="co">## [1] "Iteration: 22 bestEv: 0.374659888801639 bestIt: 22 CE: 0.374659888801639 featOrth: 0.0362359697379889"</span></span>
<span><span class="co">## [1] "Iteration: 23 bestEv: 0.370968655713385 bestIt: 23 CE: 0.370968655713385 featOrth: 0.0359521198693715"</span></span>
<span><span class="co">## [1] "Iteration: 24 bestEv: 0.3450039490402 bestIt: 24 CE: 0.3450039490402 featOrth: 0.0337079294642646"</span></span>
<span><span class="co">## [1] "Iteration: 25 bestEv: 0.263273116933031 bestIt: 25 CE: 0.263273116933031 featOrth: 0.0256382348958302"</span></span>
<span><span class="co">## [1] "Iteration: 26 bestEv: 0.263273116933031 bestIt: 25 CE: 0.479465280229821 featOrth: 0.0251698221409591"</span></span>
<span><span class="co">## [1] "Iteration: 27 bestEv: 0.256588997565246 bestIt: 27 CE: 0.256588997565246 featOrth: 0.0249475920401835"</span></span>
<span><span class="co">## [1] "Iteration: 28 bestEv: 0.256588997565246 bestIt: 27 CE: 0.474850493977991 featOrth: 0.0247110683491444"</span></span>
<span><span class="co">## [1] "Iteration: 29 bestEv: 0.251326107586204 bestIt: 29 CE: 0.251326107586204 featOrth: 0.0244188960458318"</span></span>
<span><span class="co">## [1] "Iteration: 30 bestEv: 0.249985069570705 bestIt: 30 CE: 0.249985069570705 featOrth: 0.0242610346487621"</span></span>
<span><span class="co">## [1] "Iteration: 31 bestEv: 0.23408186827619 bestIt: 31 CE: 0.23408186827619 featOrth: 0.0227896778559147"</span></span>
<span><span class="co">## [1] "Iteration: 32 bestEv: 0.232770961438407 bestIt: 32 CE: 0.232770961438407 featOrth: 0.0226771121432181"</span></span>
<span><span class="co">## [1] "Iteration: 33 bestEv: 0.232441813356411 bestIt: 33 CE: 0.232441813356411 featOrth: 0.0226403106845081"</span></span>
<span><span class="co">## [1] "Iteration: 34 bestEv: 0.231303819223013 bestIt: 34 CE: 0.231303819223013 featOrth: 0.0224599816199433"</span></span>
<span><span class="co">## [1] "Iteration: 35 bestEv: 0.228889766929636 bestIt: 35 CE: 0.228889766929636 featOrth: 0.022233414802668"</span></span>
<span><span class="co">## [1] "Iteration: 36 bestEv: 0.228530782528855 bestIt: 36 CE: 0.228530782528855 featOrth: 0.0221986524763966"</span></span>
<span><span class="co">## [1] "Iteration: 37 bestEv: 0.228530782528855 bestIt: 36 CE: 0.448693034357673 featOrth: 0.0221625638288186"</span></span>
<span><span class="co">## [1] "Iteration: 38 bestEv: 0.227729770972451 bestIt: 38 CE: 0.227729770972451 featOrth: 0.0221151720762156"</span></span>
<span><span class="co">## [1] "Iteration: 39 bestEv: 0.226522345887716 bestIt: 39 CE: 0.226522345887716 featOrth: 0.0220236770382128"</span></span>
<span><span class="co">## [1] "Iteration: 40 bestEv: 0.226495263534053 bestIt: 40 CE: 0.226495263534053 featOrth: 0.0220236769172715"</span></span>
<span><span class="co">## [1] "Iteration: 41 bestEv: 0.226495263534053 bestIt: 40 CE: 0.226495263534053 featOrth: 0.0220236769172715"</span></span>
<span><span class="co">## [1] "Iteration: 42 bestEv: 0.226495263534053 bestIt: 40 CE: 0.226495263534053 featOrth: 0.0220236769172715"</span></span>
<span><span class="co">## [1] "Iteration: 43 bestEv: 0.226495263534053 bestIt: 40 CE: 0.226495263534053 featOrth: 0.0220236769172715"</span></span>
<span><span class="co">## [1] "Iteration: 44 bestEv: 0.226495263534053 bestIt: 40 CE: 0.226495263534053 featOrth: 0.0220236769172715"</span></span>
<span><span class="co">## [1] "Iteration: 45 bestEv: 0.226495263534053 bestIt: 40 CE: 0.226495263534053 featOrth: 0.0220236769172715"</span></span>
<span><span class="co">## [1] "Iteration: 46 bestEv: 0.226495263534053 bestIt: 40 CE: 0.226495263534053 featOrth: 0.0220236769172715"</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resultNHv</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ANTsR/man/read_simlr_data_frames.html" class="external-link">read_simlr_data_frames</a></span><span class="op">(</span> <span class="va">ofn</span>, <span class="va">knm</span> <span class="op">)</span></span>
<span><span class="co">#####################################################</span></span>
<span><span class="co">#                                          #</span></span>
<span><span class="co">#                     #                    #</span></span>
<span><span class="co">#                                          #</span></span>
<span><span class="co">#####################################################</span></span>
<span><span class="co">#                                          #</span></span>
<span><span class="co">#                                          #</span></span>
<span><span class="co">#####################################################</span></span></code></pre></div>
<p>Apply the learned representations to the data matrices.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># drwwrd</span></span>
<span><span class="va">projlist</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mysimk</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">initu</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span> <span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nh_list</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">resultNHv</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">nh_list</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">simdf2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">fdatanum</span><span class="op">)</span></span>
<span><span class="va">simdf2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ANTsR/man/apply_simlr_matrices.html" class="external-link">apply_simlr_matrices</a></span><span class="op">(</span> <span class="va">simdf2</span>, <span class="va">resultNHv</span>, n_limit<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">initu</span><span class="op">)</span>, robust<span class="op">=</span><span class="cn">FALSE</span>, center<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>  scale<span class="op">=</span><span class="cn">TRUE</span>, absolute_value<span class="op">=</span><span class="va">mysigns</span><span class="op">==</span><span class="st">'positive'</span>, verbose<span class="op">=</span><span class="cn">FALSE</span> <span class="op">)</span></span>
<span><span class="va">newnames</span><span class="op">=</span><span class="va">simdf2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">simdf2</span><span class="op">=</span><span class="va">simdf2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">cognames</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"z_cerad_re"</span>, <span class="st">"z_animal_re"</span>,      <span class="st">"z_delayed_re"</span>,    <span class="st">"z_global_re"</span>,     <span class="st">"z_digit_re"</span></span>
<span><span class="co">#  "z_cerad_age", "z_animal_age",     "z_digit_age",      "z_delayed_age",    "z_global_age",</span></span>
<span><span class="co">#  "z_cerad_edu", "z_animal_edu",     "z_digit_edu",      "z_delayed_edu",    "z_global_edu"</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># cognames=c("cerad_sum","cfdast","cfdds")</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dnames</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"riagendr"</span>, <span class="st">"ridageyr"</span>, <span class="st">"race"</span>, <span class="st">"dmdeduc2"</span>, <span class="st">"INDFMPIR"</span>,<span class="st">'wtint2yr'</span>,<span class="st">'wtmec2yr'</span><span class="op">)</span></span>
<span><span class="va">simdf2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">simdf2</span><span class="op">)</span></span>
<span><span class="va">simdf2</span><span class="op">[</span>,<span class="va">dnames</span><span class="op">]</span><span class="op">=</span><span class="va">fdata</span><span class="op">[</span>,<span class="va">dnames</span><span class="op">]</span></span>
<span><span class="va">simdf2</span><span class="op">[</span>,<span class="va">cognames</span><span class="op">]</span><span class="op">=</span><span class="va">fdata</span><span class="op">[</span>,<span class="va">cognames</span><span class="op">]</span></span>
<span><span class="va">sep</span><span class="op">=</span><span class="st">'PC'</span></span>
<span><span class="va">tocomp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dietPC1"</span>,<span class="st">"mentalhealthPC1"</span>,<span class="st">'physicalPC1'</span><span class="op">)</span></span>
<span><span class="va">mycc2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span> <span class="va">simdf2</span><span class="op">[</span>,<span class="va">tocomp</span><span class="op">]</span>  <span class="op">)</span></span>
<span><span class="va">simdf2</span><span class="op">=</span><span class="va">simdf2</span><span class="op">[</span><span class="va">mycc2</span>,<span class="op">]</span></span>
<span><span class="va">simdf2</span><span class="op">[</span>,<span class="va">newnames</span><span class="op">]</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">simdf2</span><span class="op">[</span>,<span class="va">newnames</span><span class="op">]</span>,<span class="cn">T</span>,<span class="cn">T</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span> <span class="va">n</span> <span class="kw">in</span> <span class="st">'exposures'</span> <span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span> <span class="va">v</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">mysimk</span> <span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">thiscol</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">n</span>,<span class="va">sep</span>,<span class="va">v</span><span class="op">)</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span> <span class="fu"><a href="https://rdrr.io/pkg/ANTsR/man/antsImageSummary.html" class="external-link">any</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span> <span class="va">simdf2</span><span class="op">[</span>,<span class="va">thiscol</span><span class="op">]</span> <span class="op">)</span> <span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="co">#        simdf2 = simlr_impute( data.frame(simdf2), knm, v, n, separator=sep )</span></span>
<span><span class="co">#        simdf2[,thiscol]=antsrimpute(simdf2[,thiscol])</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="va">thesena</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">simdf2</span><span class="op">)</span></span>
<span><span class="va">nn</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">simdf2</span><span class="op">)</span></span>
<span><span class="co"># simdf2 = data.frame( robustMatrixTransform(simdf2))</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">simdf2</span><span class="op">)</span><span class="op">=</span><span class="va">nn</span></span>
<span><span class="va">simdf2</span><span class="op">[</span><span class="va">thesena</span><span class="op">]</span><span class="op">=</span><span class="cn">NA</span></span>
<span><span class="co">##################################</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Function to search NHANES variable descriptions</span></span>
<span><span class="va">search_nhanes_var</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">var_name_in</span>, <span class="va">dtname</span><span class="op">)</span> <span class="op">{</span>  </span>
<span>  <span class="co"># Search for the variable name (case insensitive)</span></span>
<span>  <span class="va">var_name_in</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span> <span class="st">"DR1T"</span> ,  <span class="st">"DRXT"</span> , <span class="va">var_name_in</span><span class="op">)</span></span>
<span>  <span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">nhanes_dict</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="va">var_name_in</span>, <span class="va">nhanes_dict</span><span class="op">$</span><span class="va">variable_codename_use</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">variable_description_use</span><span class="op">)</span></span>
<span>  <span class="co"># Return the first match if available</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">result</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="st">"Variable not found."</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">covars</span><span class="op">=</span><span class="st">" ~ riagendr + ridageyr + dmdeduc2  +"</span> <span class="co"># race adjusted scores</span></span>
<span><span class="va">covars</span><span class="op">=</span><span class="st">" ~ 1 +"</span> <span class="co"># race adjusted scores</span></span>
<span><span class="va">covars</span><span class="op">=</span><span class="st">" ~ riagendr + ridageyr  + dmdeduc2 + INDFMPIR + "</span></span>
<span><span class="kw">if</span> <span class="op">(</span> <span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"basep"</span><span class="op">)</span> <span class="op">)</span> <span class="va">basep</span><span class="op">=</span><span class="fl">1e-4</span></span>
<span><span class="co"># rooter</span></span>
<span><span class="kw">if</span> <span class="op">(</span> <span class="op">!</span> <span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"cogind"</span> <span class="op">)</span> <span class="op">)</span> <span class="va">cogind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cognames</span><span class="op">)</span></span>
<span><span class="co">#############################</span></span>
<span><span class="va">pnames</span><span class="op">=</span><span class="va">knm</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">nsig</span><span class="op">=</span><span class="fl">0</span></span>
<span><span class="kw">for</span> <span class="op">(</span> <span class="va">kk</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">initu</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">bform</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span> <span class="va">cognames</span><span class="op">[</span><span class="va">cogind</span><span class="op">]</span>, <span class="va">covars</span>, <span class="st">"1"</span> <span class="op">)</span></span>
<span>  <span class="va">myform</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span> <span class="va">cognames</span><span class="op">[</span><span class="va">cogind</span><span class="op">]</span>, <span class="va">covars</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">pnames</span>,<span class="va">sep</span>,<span class="va">kk</span><span class="op">)</span>, collapse<span class="op">=</span><span class="st">'+'</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">tempdf</span> <span class="op">=</span> <span class="va">simdf2</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span> <span class="va">qq</span> <span class="kw">in</span> <span class="va">knm</span> <span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tt</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">qq</span>,<span class="va">sep</span>,<span class="va">kk</span><span class="op">)</span></span>
<span>    <span class="va">tempdf</span><span class="op">[</span> , <span class="va">tt</span><span class="op">]</span><span class="op">=</span><span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/winsor.html" class="external-link">winsor</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">tempdf</span><span class="op">[</span> , <span class="va">tt</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/pkg/ANTsR/man/antsImageSummary.html" class="external-link">min</a></span><span class="op">(</span><span class="va">tempdf</span><span class="op">[</span> , <span class="va">tt</span><span class="op">]</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span>, <span class="fl">0.005</span> <span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">mdl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span> <span class="va">myform</span>, data<span class="op">=</span><span class="va">tempdf</span> <span class="op">)</span></span>
<span>  <span class="va">bmdl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span> <span class="va">bform</span>, data<span class="op">=</span><span class="va">tempdf</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mdl</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span> <span class="op">)</span></span>
<span><span class="co">#  if (doimp) mdl = lm( myform, data=tempdf, weights=tempdf$wtint2yr ) else mdl = lm( myform, data=tempdf, weights=tempdf$wtint2yr  )</span></span>
<span>  <span class="va">myanv</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span> <span class="va">bmdl</span>, <span class="va">mdl</span> <span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span> <span class="va">myanv</span><span class="op">$</span><span class="va">Pr</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;</span> <span class="va">basep</span><span class="op">/</span><span class="va">mysimk</span> <span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"*** result begin ***********************************\n"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"individual coefficients"</span><span class="op">)</span></span>
<span>    <span class="va">tailcoffs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coefficients</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span> <span class="va">mdl</span> <span class="op">)</span> <span class="op">)</span>, <span class="fl">4</span> <span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="va">tailcoffs</span> <span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"multivar-ANOVA p-value"</span>, <span class="fu">insight</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/insight/reference/format_p.html" class="external-link">format_p</a></span><span class="op">(</span><span class="va">myanv</span><span class="op">$</span><span class="va">Pr</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span> <span class="op">)</span> <span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="va">cognames</span><span class="op">[</span><span class="va">cogind</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">gglist</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">simpreds</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">simwts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span> <span class="va">k</span> <span class="kw">in</span> <span class="va">pnames</span> <span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Simlr weights"</span>, <span class="va">k</span> <span class="op">)</span> <span class="op">)</span></span>
<span>      <span class="va">ivec</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ANTsR/man/interpret_simlr_vector2.html" class="external-link">interpret_simlr_vector2</a></span><span class="op">(</span> <span class="va">resultNHv</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span>, <span class="va">kk</span>, n2show<span class="op">=</span><span class="fl">3</span>, shortnames<span class="op">=</span><span class="cn">F</span> <span class="op">)</span></span>
<span>      <span class="va">interpname</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/subtyper/man/shorten_names.html" class="external-link">shorten_names</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> </span>
<span>        <span class="fu">search_nhanes_var</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ivec</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span>,</span>
<span>        <span class="fu">search_nhanes_var</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ivec</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">)</span>,</span>
<span>        <span class="fu">search_nhanes_var</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ivec</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">)</span> <span class="op">)</span> <span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ivec</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ivec</span><span class="op">)</span><span class="op">]</span><span class="op">=</span><span class="va">interpname</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="va">ivec</span> <span class="op">)</span></span>
<span>      <span class="va">siminds</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span></span>
<span>      <span class="va">simpreds</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="va">simpreds</span>, <span class="va">interpname</span><span class="op">[</span><span class="va">siminds</span><span class="op">]</span> <span class="op">)</span></span>
<span>      <span class="va">simwts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="va">simwts</span>, <span class="va">ivec</span><span class="op">[</span><span class="va">siminds</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="va">tailcoffs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">k</span>,<span class="va">sep</span>,<span class="va">kk</span><span class="op">)</span>,<span class="st">"t value"</span><span class="op">]</span> <span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">ttl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">k</span>,<span class="va">kk</span>, <span class="st">" "</span>, <span class="fu">insight</span><span class="fu">::</span><span class="fu"><a href="https://easystats.github.io/insight/reference/format_p.html" class="external-link">format_p</a></span><span class="op">(</span><span class="va">tailcoffs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">k</span>,<span class="va">sep</span>,<span class="va">kk</span><span class="op">)</span>,<span class="st">"Pr(&gt;|t|)"</span><span class="op">]</span>,digits<span class="op">=</span><span class="fl">4</span><span class="op">)</span>  <span class="op">)</span></span>
<span>      <span class="va">gglist</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">gglist</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="fu">visreg</span><span class="fu">::</span><span class="fu"><a href="http://pbreheny.github.io/visreg/reference/visreg.html" class="external-link">visreg</a></span><span class="op">(</span><span class="va">mdl</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">k</span>,<span class="va">sep</span>,<span class="va">kk</span><span class="op">)</span>, gg<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="va">ttl</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/pkg/subtyper/man/plot_regression_graph.html" class="external-link">plot_regression_graph</a></span><span class="op">(</span> <span class="va">simpreds</span>, <span class="va">simwts</span>, <span class="va">cognames</span><span class="op">[</span><span class="va">cogind</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"alluvial"</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="co">#    sankey &lt;- plot_regression_graph(simpreds, simwts, cognames[cogind], method = "sankey")</span></span>
<span><span class="co">#    saveWidget(sankey, "sankey_plot.html", selfcontained = TRUE)</span></span>
<span><span class="co">#    htmltools::includeHTML("sankey_plot.html")</span></span>
<span>    <span class="op">(</span> <span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span> grobs<span class="op">=</span><span class="va">gglist</span>, nrow<span class="op">=</span><span class="fl">2</span> <span class="op">)</span> <span class="op">)</span></span>
<span>    <span class="va">nsig</span><span class="op">=</span><span class="va">nsig</span><span class="op">+</span><span class="fl">1</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"*** result end ***********************************\n\n"</span><span class="op">)</span></span>
<span><span class="co">#    Sys.sleep(3)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## *** result begin ***********************************</span></span>
<span><span class="co">## [1] "individual coefficients"</span></span>
<span><span class="co">##                   Estimate Std. Error   t value     Pr(&gt;|t|)</span></span>
<span><span class="co">## dietPC7         -0.2869831 0.09584767 -2.994158 2.798740e-03</span></span>
<span><span class="co">## exposuresPC7     0.3390503 0.08564743  3.958674 7.902529e-05</span></span>
<span><span class="co">## mentalhealthPC7 -0.1166445 0.03424454 -3.406221 6.767331e-04</span></span>
<span><span class="co">## physicalPC7      0.1485776 0.08912400  1.667088 9.571325e-02</span></span>
<span><span class="co">## [1] "multivar-ANOVA p-value p = 1.9731e-08"</span></span>
<span><span class="co">## [1] "z_digit_re"</span></span>
<span><span class="co">## [1] "Simlr weights diet"</span></span>
<span><span class="co">## mfa 2:1 (docosenoic)          sodium (mg) tot monounsaturated  </span></span>
<span><span class="co">##           -1.0000000           -0.7857572           -0.7715333 </span></span>
<span><span class="co">## [1] "Simlr weights exposures"</span></span>
<span><span class="co">##  blod cadmium (ug/l) serum selenium repli blod lead replicate  </span></span>
<span><span class="co">##           -1.0000000            0.4356850           -0.1517635 </span></span>
<span><span class="co">## [1] "Simlr weights mentalhealth"</span></span>
<span><span class="co">## trouble concentratin feling tired or havi moving or speaking s </span></span>
<span><span class="co">##            1.0000000            0.9517744            0.5458968 </span></span>
<span><span class="co">## [1] "Simlr weights physical"</span></span>
<span><span class="co">## standing height (cm) uper arm length (cm) uper leg length (cm) </span></span>
<span><span class="co">##            1.0000000            0.7319379            0.6162244</span></span></code></pre>
<p><img src="simlr_nhanes_files/figure-html/nhanessimlrstatlm-1.png" width="960"><img src="simlr_nhanes_files/figure-html/nhanessimlrstatlm-2.png" width="960"></p>
<pre><code><span><span class="co">## *** result end ***********************************</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## *** result begin ***********************************</span></span>
<span><span class="co">## [1] "individual coefficients"</span></span>
<span><span class="co">##                    Estimate Std. Error   t value    Pr(&gt;|t|)</span></span>
<span><span class="co">## dietPC10         -0.7145128 0.18611568 -3.839079 0.000128824</span></span>
<span><span class="co">## exposuresPC10    -0.1496291 0.04940432 -3.028664 0.002499857</span></span>
<span><span class="co">## mentalhealthPC10 -0.1132930 0.03539023 -3.201249 0.001398060</span></span>
<span><span class="co">## physicalPC10      0.1454703 0.06523180  2.230051 0.025896921</span></span>
<span><span class="co">## [1] "multivar-ANOVA p-value p = 3.7015e-08"</span></span>
<span><span class="co">## [1] "z_digit_re"</span></span>
<span><span class="co">## [1] "Simlr weights diet"</span></span>
<span><span class="co">## dietary fiber (gm)     magnesium (mg)         coper (mg) </span></span>
<span><span class="co">##          1.0000000          0.9452456          0.7483246 </span></span>
<span><span class="co">## [1] "Simlr weights exposures"</span></span>
<span><span class="co">##  blod cadmium (ug/l) methylmercury (ug/l) blod mercury, tot (u </span></span>
<span><span class="co">##           1.00000000           0.04517476           0.04406620 </span></span>
<span><span class="co">## [1] "Simlr weights mentalhealth"</span></span>
<span><span class="co">## por apetite or overe feling down, deprese moving or speaking s </span></span>
<span><span class="co">##            1.0000000            0.6183647            0.4154595 </span></span>
<span><span class="co">## [1] "Simlr weights physical"</span></span>
<span><span class="co">## sagital abdominal di waist circumference  diastolic: blod pres </span></span>
<span><span class="co">##            1.0000000            0.4672899            0.4490129</span></span></code></pre>
<p><img src="simlr_nhanes_files/figure-html/nhanessimlrstatlm-3.png" width="960"><img src="simlr_nhanes_files/figure-html/nhanessimlrstatlm-4.png" width="960"></p>
<pre><code><span><span class="co">## *** result end ***********************************</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## *** result begin ***********************************</span></span>
<span><span class="co">## [1] "individual coefficients"</span></span>
<span><span class="co">##                     Estimate Std. Error    t value     Pr(&gt;|t|)</span></span>
<span><span class="co">## dietPC15          0.31927974 0.06395639  4.9921474 6.695521e-07</span></span>
<span><span class="co">## exposuresPC15     0.03979127 0.05201872  0.7649414 4.444311e-01</span></span>
<span><span class="co">## mentalhealthPC15 -0.12651218 0.03423500 -3.6954048 2.277224e-04</span></span>
<span><span class="co">## physicalPC15      0.24778010 0.07031393  3.5239118 4.384654e-04</span></span>
<span><span class="co">## [1] "multivar-ANOVA p-value p = 1.3527e-09"</span></span>
<span><span class="co">## [1] "z_digit_re"</span></span>
<span><span class="co">## [1] "Simlr weights diet"</span></span>
<span><span class="co">## number of fods/bever vitamin e as alpha-t      vitamin k (mcg) </span></span>
<span><span class="co">##            1.0000000            0.4682773            0.3668329 </span></span>
<span><span class="co">## [1] "Simlr weights exposures"</span></span>
<span><span class="co">## methylmercury (ug/l) blod mercury, tot (u serum selenium repli </span></span>
<span><span class="co">##            1.0000000            0.9890593            0.1504698 </span></span>
<span><span class="co">## [1] "Simlr weights mentalhealth"</span></span>
<span><span class="co">## trouble concentratin por apetite or overe feling bad about you </span></span>
<span><span class="co">##            1.0000000            0.9949505            0.9607797 </span></span>
<span><span class="co">## [1] "Simlr weights physical"</span></span>
<span><span class="co">## arm circumference (c body mas index (kg/m          weight (kg) </span></span>
<span><span class="co">##            1.0000000            0.8069592            0.7202401</span></span></code></pre>
<p><img src="simlr_nhanes_files/figure-html/nhanessimlrstatlm-5.png" width="960"><img src="simlr_nhanes_files/figure-html/nhanessimlrstatlm-6.png" width="960"></p>
<pre><code><span><span class="co">## *** result end ***********************************</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## *** result begin ***********************************</span></span>
<span><span class="co">## [1] "individual coefficients"</span></span>
<span><span class="co">##                     Estimate Std. Error   t value     Pr(&gt;|t|)</span></span>
<span><span class="co">## dietPC18         -0.89452551 0.23599947 -3.790371 1.566017e-04</span></span>
<span><span class="co">## exposuresPC18     0.09403167 0.07053923  1.333041 1.827283e-01</span></span>
<span><span class="co">## mentalhealthPC18 -0.16736694 0.03630774 -4.609677 4.388195e-06</span></span>
<span><span class="co">## physicalPC18      0.23117400 0.06689039  3.456012 5.640919e-04</span></span>
<span><span class="co">## [1] "multivar-ANOVA p-value p = 5.3370e-09"</span></span>
<span><span class="co">## [1] "z_digit_re"</span></span>
<span><span class="co">## [1] "Simlr weights diet"</span></span>
<span><span class="co">## number of fods/bever         cafeine (mg)       vitamin c (mg) </span></span>
<span><span class="co">##           -1.0000000            0.7365872           -0.7311934 </span></span>
<span><span class="co">## [1] "Simlr weights exposures"</span></span>
<span><span class="co">## blod lead replicate  serum selenium repli blod manganese (ug/l </span></span>
<span><span class="co">##           1.00000000           0.31393840          -0.03949374 </span></span>
<span><span class="co">## [1] "Simlr weights mentalhealth"</span></span>
<span><span class="co">## moving or speaking s trouble concentratin feling tired or havi </span></span>
<span><span class="co">##            1.0000000            0.8610831            0.4037249 </span></span>
<span><span class="co">## [1] "Simlr weights physical"</span></span>
<span><span class="co">## body mas index (kg/m waist circumference  arm circumference (c </span></span>
<span><span class="co">##            1.0000000            0.8627970            0.7971954</span></span></code></pre>
<p><img src="simlr_nhanes_files/figure-html/nhanessimlrstatlm-7.png" width="960"><img src="simlr_nhanes_files/figure-html/nhanessimlrstatlm-8.png" width="960"></p>
<pre><code><span><span class="co">## *** result end ***********************************</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## *** result begin ***********************************</span></span>
<span><span class="co">## [1] "individual coefficients"</span></span>
<span><span class="co">##                     Estimate Std. Error    t value     Pr(&gt;|t|)</span></span>
<span><span class="co">## dietPC19         -0.64488770 0.17744751 -3.6342449 0.0002885518</span></span>
<span><span class="co">## exposuresPC19     0.29985337 0.09405452  3.1880804 0.0014628514</span></span>
<span><span class="co">## mentalhealthPC19 -0.02038159 0.03232947 -0.6304338 0.5285103215</span></span>
<span><span class="co">## physicalPC19      0.19464195 0.07301061  2.6659404 0.0077628109</span></span>
<span><span class="co">## [1] "multivar-ANOVA p-value p = 1.7810e-06"</span></span>
<span><span class="co">## [1] "z_digit_re"</span></span>
<span><span class="co">## [1] "Simlr weights diet"</span></span>
<span><span class="co">##         alcohol (gm) number of fods/bever        moisture (gm) </span></span>
<span><span class="co">##           -1.0000000           -0.8784147            0.8163919 </span></span>
<span><span class="co">## [1] "Simlr weights exposures"</span></span>
<span><span class="co">##  blod cadmium (ug/l) methylmercury (ug/l) blod mercury, tot (u </span></span>
<span><span class="co">##          -1.00000000          -0.02191980          -0.02177431 </span></span>
<span><span class="co">## [1] "Simlr weights mentalhealth"</span></span>
<span><span class="co">## ever told doctor had ever told by doctor  trouble sleping or s </span></span>
<span><span class="co">##            1.0000000            0.6589933            0.4531027 </span></span>
<span><span class="co">## [1] "Simlr weights physical"</span></span>
<span><span class="co">## diastolic: blod pres diastolic: blod pres arm circumference (c </span></span>
<span><span class="co">##            1.0000000            0.9216930            0.6808037</span></span></code></pre>
<p><img src="simlr_nhanes_files/figure-html/nhanessimlrstatlm-9.png" width="960"><img src="simlr_nhanes_files/figure-html/nhanessimlrstatlm-10.png" width="960"></p>
<pre><code><span><span class="co">## *** result end ***********************************</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## *** result begin ***********************************</span></span>
<span><span class="co">## [1] "individual coefficients"</span></span>
<span><span class="co">##                     Estimate Std. Error   t value     Pr(&gt;|t|)</span></span>
<span><span class="co">## dietPC21          0.06227236 0.08858882  0.702937 4.822081e-01</span></span>
<span><span class="co">## exposuresPC21     0.31541703 0.12194125  2.586631 9.788789e-03</span></span>
<span><span class="co">## mentalhealthPC21 -0.17181026 0.03731900 -4.603828 4.511475e-06</span></span>
<span><span class="co">## physicalPC21      0.16629009 0.08171522  2.034995 4.203329e-02</span></span>
<span><span class="co">## [1] "multivar-ANOVA p-value p = 5.8532e-07"</span></span>
<span><span class="co">## [1] "z_digit_re"</span></span>
<span><span class="co">## [1] "Simlr weights diet"</span></span>
<span><span class="co">##   tot sugars (gm) carbohydrate (gm)   vitamin k (mcg) </span></span>
<span><span class="co">##         1.0000000         0.8810216        -0.7332929 </span></span>
<span><span class="co">## [1] "Simlr weights exposures"</span></span>
<span><span class="co">##  blod cadmium (ug/l)  ethylmercury (ug/l) blod lead replicate  </span></span>
<span><span class="co">##          -1.00000000          -0.28462367           0.04404004 </span></span>
<span><span class="co">## [1] "Simlr weights mentalhealth"</span></span>
<span><span class="co">## moving or speaking s trouble concentratin feling down, deprese </span></span>
<span><span class="co">##            1.0000000            0.6120201            0.4283250 </span></span>
<span><span class="co">## [1] "Simlr weights physical"</span></span>
<span><span class="co">## uper arm length (cm)          weight (kg) waist circumference  </span></span>
<span><span class="co">##            1.0000000            0.9571644            0.7645044</span></span></code></pre>
<p><img src="simlr_nhanes_files/figure-html/nhanessimlrstatlm-11.png" width="960"><img src="simlr_nhanes_files/figure-html/nhanessimlrstatlm-12.png" width="960"></p>
<pre><code><span><span class="co">## *** result end ***********************************</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## *** result begin ***********************************</span></span>
<span><span class="co">## [1] "individual coefficients"</span></span>
<span><span class="co">##                    Estimate Std. Error   t value     Pr(&gt;|t|)</span></span>
<span><span class="co">## dietPC23          0.1674127 0.08747699  1.913791 5.584394e-02</span></span>
<span><span class="co">## exposuresPC23     0.2542170 0.14728594  1.726010 8.455907e-02</span></span>
<span><span class="co">## mentalhealthPC23 -0.1903865 0.03649339 -5.217013 2.082345e-07</span></span>
<span><span class="co">## physicalPC23      0.2013599 0.06908529  2.914656 3.615569e-03</span></span>
<span><span class="co">## [1] "multivar-ANOVA p-value p = 2.0301e-08"</span></span>
<span><span class="co">## [1] "z_digit_re"</span></span>
<span><span class="co">## [1] "Simlr weights diet"</span></span>
<span><span class="co">##      tot sugars (gm) riboflavin (vitamin      theobromine (mg) </span></span>
<span><span class="co">##            1.0000000            0.8910406            0.7947872 </span></span>
<span><span class="co">## [1] "Simlr weights exposures"</span></span>
<span><span class="co">## blod lead replicate   blod cadmium (ug/l) blod manganese (ug/l </span></span>
<span><span class="co">##           -1.0000000           -0.5789280            0.2313187 </span></span>
<span><span class="co">## [1] "Simlr weights mentalhealth"</span></span>
<span><span class="co">## moving or speaking s ever told by doctor  thought you would be </span></span>
<span><span class="co">##            1.0000000            0.5533839            0.4841447 </span></span>
<span><span class="co">## [1] "Simlr weights physical"</span></span>
<span><span class="co">## body mas index (kg/m arm circumference (c          weight (kg) </span></span>
<span><span class="co">##            1.0000000            0.9271943            0.6741194</span></span></code></pre>
<p><img src="simlr_nhanes_files/figure-html/nhanessimlrstatlm-13.png" width="960"><img src="simlr_nhanes_files/figure-html/nhanessimlrstatlm-14.png" width="960"></p>
<pre><code><span><span class="co">## *** result end ***********************************</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## *** result begin ***********************************</span></span>
<span><span class="co">## [1] "individual coefficients"</span></span>
<span><span class="co">##                    Estimate Std. Error   t value     Pr(&gt;|t|)</span></span>
<span><span class="co">## dietPC36          0.1606064 0.06703214  2.395961 0.0167031984</span></span>
<span><span class="co">## exposuresPC36    -0.1701190 0.04846182 -3.510372 0.0004612112</span></span>
<span><span class="co">## mentalhealthPC36 -0.1148066 0.03362479 -3.414344 0.0006570302</span></span>
<span><span class="co">## physicalPC36      0.1265146 0.06829968  1.852345 0.0641798158</span></span>
<span><span class="co">## [1] "multivar-ANOVA p-value p = 1.1127e-06"</span></span>
<span><span class="co">## [1] "z_digit_re"</span></span>
<span><span class="co">## [1] "Simlr weights diet"</span></span>
<span><span class="co">## pfa 20:4 (eicosatetr mfa 2:1 (docosenoic) mfa 16:1 (hexadeceno </span></span>
<span><span class="co">##            1.0000000            0.7849900            0.7378899 </span></span>
<span><span class="co">## [1] "Simlr weights exposures"</span></span>
<span><span class="co">##  blod cadmium (ug/l)  ethylmercury (ug/l) blod manganese (ug/l </span></span>
<span><span class="co">##           1.00000000           0.14515331           0.02476465 </span></span>
<span><span class="co">## [1] "Simlr weights mentalhealth"</span></span>
<span><span class="co">## por apetite or overe ever told by doctor  moving or speaking s </span></span>
<span><span class="co">##            1.0000000            0.6243751            0.4891688 </span></span>
<span><span class="co">## [1] "Simlr weights physical"</span></span>
<span><span class="co">## diastolic: blod pres diastolic: blod pres diastolic: blod pres </span></span>
<span><span class="co">##            1.0000000            0.9373342            0.7513996</span></span></code></pre>
<p><img src="simlr_nhanes_files/figure-html/nhanessimlrstatlm-15.png" width="960"><img src="simlr_nhanes_files/figure-html/nhanessimlrstatlm-16.png" width="960"></p>
<pre><code><span><span class="co">## *** result end ***********************************</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## *** result begin ***********************************</span></span>
<span><span class="co">## [1] "individual coefficients"</span></span>
<span><span class="co">##                     Estimate Std. Error    t value     Pr(&gt;|t|)</span></span>
<span><span class="co">## dietPC44          0.22799162 0.06236622  3.6556908 0.0002656686</span></span>
<span><span class="co">## exposuresPC44    -0.25714767 0.07033643 -3.6559673 0.0002653850</span></span>
<span><span class="co">## mentalhealthPC44 -0.01958409 0.03116508 -0.6283985 0.5298420849</span></span>
<span><span class="co">## physicalPC44      0.20492654 0.07396157  2.7707164 0.0056648696</span></span>
<span><span class="co">## [1] "multivar-ANOVA p-value p = 2.0472e-07"</span></span>
<span><span class="co">## [1] "z_digit_re"</span></span>
<span><span class="co">## [1] "Simlr weights diet"</span></span>
<span><span class="co">##     tot folate (mcg)     fod folate (mcg) folate as dietary fo </span></span>
<span><span class="co">##            1.0000000            0.9602400            0.8908203 </span></span>
<span><span class="co">## [1] "Simlr weights exposures"</span></span>
<span><span class="co">##  blod cadmium (ug/l) serum selenium repli blod manganese (ug/l </span></span>
<span><span class="co">##           1.00000000          -0.13819490           0.09366044 </span></span>
<span><span class="co">## [1] "Simlr weights mentalhealth"</span></span>
<span><span class="co">## ever told doctor had trouble sleping or s ever told by doctor  </span></span>
<span><span class="co">##            1.0000000            0.2716266            0.1882259 </span></span>
<span><span class="co">## [1] "Simlr weights physical"</span></span>
<span><span class="co">## diastolic: blod pres diastolic: blod pres arm circumference (c </span></span>
<span><span class="co">##            1.0000000            0.8732577            0.6396631</span></span></code></pre>
<p><img src="simlr_nhanes_files/figure-html/nhanessimlrstatlm-17.png" width="960"><img src="simlr_nhanes_files/figure-html/nhanessimlrstatlm-18.png" width="960"></p>
<pre><code><span><span class="co">## *** result end ***********************************</span></span></code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">nsig</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 9</span></span></code></pre>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##########################################################################################</span></span>
<span><span class="co">##########################################################################################</span></span>
<span><span class="co"># https://wwwn.cdc.gov/nchs/nhanes/search/default.aspx</span></span>
<span><span class="co"># &gt; interpret_simlr_vector2( resultNHv[['exposures']], 1, n2show=5, shortnames=F )</span></span>
<span><span class="co">#   LBXVBZ    LBXVOX    LBXVFN    LBX2DF </span></span>
<span><span class="co"># benzene, Xylene, furan, Dimethylfuran</span></span>
<span><span class="co"># 1.0000000 0.3346728 0.1868323 0.0586727 </span></span>
<span><span class="co">##########################################################################################</span></span></code></pre></div>
<p><strong>References</strong></p>
<ul>
<li><p>Avants BB, Tustison NJ, Stone JR. Similarity-driven multi-view
embeddings from high-dimensional biomedical data. Nature computational
science. 2021 Feb;1(2):143-52.</p></li>
<li><p>James G, Witten D, Hastie T, Tibshirani R. An introduction to
statistical learning. New York: springer; 2013 Jun 24.</p></li>
<li><p>Livingston G, Huntley J, Sommerlad A, Ames D, Ballard C, Banerjee
S, Brayne C, Burns A, Cohen-Mansfield J, Cooper C, Costafreda SG.
Dementia prevention, intervention, and care: 2020 report of the Lancet
Commission. The lancet. 2020 Aug 8;396(10248):413-46.</p></li>
<li><p>Stern Y. Cognitive reserve in ageing and Alzheimer’s disease. The
Lancet Neurology. 2012 Nov 1;11(11):1006-12.</p></li>
<li><p>Kline A, Wang H, Li Y, Dennis S, Hutch M, Xu Z, Wang F, Cheng F,
Luo Y. Multimodal machine learning in precision health: A scoping
review. npj Digital Medicine. 2022 Nov 7;5(1):171.</p></li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Brian Avants.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
